ADDON_SUMMARY - user's manual
Author: ADDON_AUTHOR_NAME


%!includeconf: ../addon_userManual.t2tconf
%!includeconf: addon_informations.t2tconf
%!includeconf: addon_keys.t2tconf

URL: [ADDON_REPOSITORY ADDON_REPOSITORY]



Download:
- [stable version ADDON_CUR_VERSION ADDON_DOWNLOAD_SERVER1]
- [developpement's version ADDON_DEV_URL]


Compatibility:
- Nminimum supported NVDA version : MINIMUM_NVDA_VERSION
- last tested NVDA version: LAST_TESTED_NVDA_VERSION


Traductor (s): based on automatic translation from french language
= Sommaire =[toc]
%%toc



on going redaction
+ Introduction +
++ General ++
This add-on adds to NVDA's global commands:
- The following features:
 - [Display of the list of icons in the notification area or windows of applications launched #hdr1],
 - [Help with the composition of complex symbols #hdr3] such as for example an "e" in the "o", an inverted question mark ...,
 - [Announcement or display of information about the application under focus, such as its version, the active configuration profile, loaded add-on #hdr4],
 - [Virtual buffer functionality extension #hdr5] for Mozilla Firefox, Microsoft Internet Explorer, Microsoft Edge and Google Chrome browsers:
  - new commands for navigation mode: paragraph, division, anchor, main region,
  - new types of elements presented in list form in the "List of elements" dialog box opened by NVDA + f7: (radio button, paragraph, frame, checkbox, ...) and announcement of the number of elements corresponding to the selected type,
  - announcement of the address (URL) of the document,
  - option to browse in a loop in search of a next or previous item,
  - [scripts to click at the current position of the browser object #hdr23],
  - scripts for tables:
   - announcement of the position of the current cell,
   - move to the next or previous column / row with reading of the cells composing it,
   - move to the first / last cell of the row / column (keep for NVDA versions lower than 2022.2),
   - announcement of the cells of the current column / row.
 - [Announcement of the function associated with the keyboard editing commands #hdr7] with:
  - adding the selected text to the clipboard,
  - emptying the clipboard,
  - improvement of the NVDA base script "NVDA+c" which announces the text in the clipboard,
 - [Announcement of the pre-selected folder in the "Open, Save", "Save as" style dialog boxes #hdr8],
 - [Open previous or current NVDA log and copy their path to clipboard # hdr9],
 - [history of voice speechs #hdr10],
 - [renaming keyboard keys #hdr12],
 - [selective announcement of command keys #hdr13],
 - [simple countdown timer #hdr14],
 - [restarting NVDA in "debugging" logging level by simple input gesture #hdr15],
 - [display of visible elements making up the object in the foreground #hdr16],
 - [quick voice profile switching #hdr17],
 - [persistence of NVDA and modification keys and specific persistence for the gmail.com site #hdr18],
 - [Shutdown, restart or hibernate computer #hdr19],
 - management of input gestures configured by user,
 - [sound control #hdr21] (Windows 10 only):
  - mute or unmute volume for the focused application,
  - manually or automatically establish the main sound and that of the NVDA audio stream,
  - modify the level of the main volume or that of the audio stream of the application under focus,
  - automatic recovery of the main volume and NVDA when loading the extension,
  - [temporary use of an audio output device without impacting the NVDA configuration # hdr33],
  [NVDA audio output orientation and applications #hdr34],
  -[NVDA tones and sounds volume adjustment #hdr34],
 - [Tools for the development of add-ons #hdr22],
 - [Complements concerning the date and time #hdr24]:
  - copy of the date and time to the clipboard,
  - Announce the time on the Windows clock with seconds,
  - announcement of the time independent of the punctuation level.
 - [user configurations management and NVDA restarting with precise configuration #HDR23],
 - [text analyzer # hdr31],
 - [ quick add-ons activation or desactivation #hdr35],
- The options:
 - [removal of the announcement of the description of objects in Windows ribbons #hdr100],
 - [automatic window maximization #hdr102],
 - [systematic announcement of punctuation marks when moving by word #hdr103],
 - [possibility of signaling spelling errors by a double beep or by a voice announcement instead of the sound emitted by NVDA # hdr104],
 - [possibility to block the "Insert" and "Caps lock" keys #hdr105],
 - [Pronunciation of non-alphanumeric characters when per-character keyboard echo is disabled #hdr106].
- advanced options:
 - [Signaling by a sound of the entry of an error in the log of NVDA #hdr300],
 - [Title of the add-on's dialog boxes with the add-on's summary #hdr302],
 - [configuration of the wait time delay for repeating the same input gesture #hdr303],
 - [possible use of numeric keypad keys as standard #hdr304].
 - [possibility to limit the repetition of keys #hdr306],
- and the other improvements:
 - [menu to explore user configuration folder or NVDA program folder #hdr202],
 - [presentation of text formatting information in a dialog box instead of an HTML document #hdr203],
 - [Announcement of confirmation style dialog box text even if item description announcement is disabled #hdr204].
 - [announcement of the cursor position in the edit boxes # hdr32],
 - [script to emulate the "Applications" key # hdr25],
 - [script to close all open windows # hdr26],
 - [script to display the list of running add-ons #hdr27].
 - [possibility of executing scripts in the "input gestures" dialog # hdr205],
 - [automatic selection of the category in the dialog "Input gestures" # hdr206].
 - [Selection of the last setting  used in the synthesizer settings ring # hdr207].
 - [Enhancements for Windows Explorer#hdr208]:
  - a script to announce the access path of the folder or the file which is under the cursor of the Windows explorer, or copy this path in the clipboard.
  - a script to announce, going up the folder tree, the name of the folders making up the path of the folder containing the element under the cursor.
 - [Speak typed word enhancement #hdr209].


++ Add-on configuration menu ++[hdr-configurationMenu]
In NVDA's "Preferences" sub-menu, the "ADDON_SUMMARY" sub-menu has been added which offers the following choices, depending on the case:
- systematically "the Global settings" sub-menu which opens a dialog resembling the "parameters" dialog of NVDA and which presents the following categories:
 - "Feature installation": allows you to see the installation status of each feature provided by the add-on and possibly modify it.
 - "Complements to NVDA": to configure the options related to NVDA provided by the add-on,
 - "Computer": to configure the options related to the functions relating to the computer (Windows operating system, volume control),
 - "Keyboard": to configure the options linked to the keyboard (key remanence, use of the numeric keypad),
 - "Advanced":options for experienced users,
 - "update": settings controlling the update of the add-on.

- systematically "the Current configuration profile settings" sub-menu which opens a dialog resembling the "parameters" dialog of NVDA and which presents the following categories:
 - "Complements to NVDA": to configure the options related to NVDA provided by the add-on,
 - text analyzer ": to define options specific to the text analyzer.
- "Keyboard keys renaming" (if the functionality is installed): allows you to modify the names of the keyboard keys given by default by NVDA as required,
- "Selective announcement of the keyboard keys" (if the functionality is installed): allows the name of the keyboard keys to be announced selectively, as needed,
- "Reset the configuration" to restore the configuration to its initial state when the add-on is first installed.


Apart from the last menu, each is associated with a script without a input gesture allowing it to be activated. With the dialog "gestures of commands" of NVDA it is possible to assign them one.

These are the following scripts with their interpreter command:
- "Display the add-on settings dialog": "KEY_ADDON_SETTINGS" command,
- "Display the dialog for configuring the add-on for the current configuration profile": "KEY_PROFILE_SETTINGS" command,
- "Display the keyboard keys renaming dialog": "KEY_RENAMING" command,
- "Display the dialog to configure the selective announcements of the command keys": "KEY_RENAMING" command,


This configuration is saved in two ways depending on the functionality or option concerned:
- in the "NVDAExtensionGlobalPluginAddon.ini" file placed in the user folder "userConfig" of NVDA for the configuration used regardless of the configuration profile,
- in the NVDA.ini file or the configuration profile file of the profile triggered at the time of the modification for the configuration that will be used only when this profile is triggered.


NVDA offers the option "Save configuration on exiting" (see NVDA user manual) which allows to automatically save NVDA configuration when exiting or restarting NVDA. If this option is not checked, the configuration is only saved upon user action or upon modification of a parameter that requires restarting NVDA.

This add-on follows this mode of operation.

Some add-on setting changes require saving the configuration and restarting NVDA. In this case, the user is offered to save and immediately restart as NVDA does when there is a change of language.


When uninstalling the add-on, its configuration file is deleted and the add-on's configuration is cleared from all configuration profiles.

When uninstalling a feature, its configuration, if any, is completely deleted.

In the case of an update, installing the add-on offers the possibility of keeping (as far as possible) or not the previous configuration.


Using the "Reset configuration" submenu, it is possible to restore the configuration to the same state as when the add-on was first installed, including the one saved in the configuration profiles.

This allows you to start from scratch without having to uninstall and reinstall the add-on in case of possible problems.


++ Contextual help ++
In most of the extension's dialogs, it is possible using the "F1" key to open the extension user manual to the most appropriate chapter.
++ update ++[hdr-update]
The update of the add-on is, by default, automatically a short time after the start of NVDA (between 20 and 600 seconds) and a maximum of once per day.
It is possible to disable this update by unchecking the option "automatically check for updates" of "Update" category in the add-on's settings.
The version of the add-on can be:
- a stable version: its version number is "1.0" for example.
- either a development version: the version number is of the type "1.0-dev1", or "1.0-rc1", or "1.0-beta2".


By default, the stable version is updated with a stable version more recent (higher version number).
But it is possible to update the stable version running with a development version of the next stable version. Just check the option "Update also update the stable release to the versions of development" located in the "Update" category of add-on's settings.

A development version is updated:
- with a more recent development version,
- with its stable version,
- or with the latest stable version if the previous option is not checked.


The button "Search for update" placed in the add-on's settings, menu item "Update", allows you to search immediately for an update.


The "View history" button, placed in this same category, allows you to display the history of the current version in the browser.

In the case of an automatic update and if a new version is detected, the "Update" dialog box is displayed to suggest:
- either the immediate installation of the new version,
- or to postpone the update until later. In this case, the search will be restarted at least one hour later.


In the case of an update to a stable version, the "What's new" button offers the possibility of opening, in the browser, the history of the add-on and thus being able to know the new features of the proposed version.

++ Safe mode operation ++
In this mode, the operation of the add-on is degraded.

Like NVDA, it is not possible to save configuration changes.

Some features are no longer available, such as:
- "Display of the list of icons in the notification area and windows of launched applications",
- "NVDA logs",
- "Development tools".
- update of the add-on.


++ Compatibility ++
The configuration of the "Voice profile switching" functionality having changed, it is deleted during an update from a version of the add-on older than 9.0. All selectors are released and the associated voice profiles are deleted.


++ History ++
The version history of this add-on is in the ["changes.html" file changes.html]

+ Features +[hdr0]
++ Preamble ++[hdr0-1]
+++ Installation of a feature +++
This add-on allows you to install or not install a particular feature.
The installation status of each feature of the add-on is presented in the "features's installation" category of the "Settings" dialog.

This state can be:
- Do not install: the feature is not installed.
- Install: the feature is installed. Its scripts can be used using the commands of the command interpreter (see next chapter) and the input gestures provided by default.
- Install without input gesture: the functionality is installed. Its scripts can be used using the commands of the command interpreter (see next chapter), but no input gesture is assigned to them.


By default, this add-on does not install all features.

+++ Activation of scripts +++[hdr0-2]
In general, each script can be activated in two ways:
- either using a classic input gesture,
- or by using the command interpreter of the add-on (see next chapter).


In NVDA's "Input gestures" dialog, the scripts provided by the add-on are placed in their own category.

The vast majority of scripts fall into the categories: "ADDON_SUMMARY", "Voice Profile Switching", "Configuration", "Tools" and Speech.

For scripts that can be started by an interpreter command, thiscommand is indicated after the description of the script.

Depending on the choice of installing a feature ("Install" or "Install without input gesture"), the input gestures provided by default are assigned or not to the scripts of this feature.

By default, the vast majority of scripts that can be started by the command interpreter are not assigned to any input gestures.

+++ Command interpreter +++[hdr0-1-3]
This is started using the "KEY_SHELL" input gesture. A beep is then audible.

It is then possible to activate the scripts of the functionalities using commands.Today, these commands cannot be changed.

The "KEY_HELP_SHELL" command of the interpreter lists all the scripts of the installed functionalities accessible by a command of the interpreter. In this list, it is possible to launch the selected script by pressing the "Enter" key.

The "KEY_MODULE_GUIDE" command of the interpreter opens the add-on's user guide.

The command interpreter stops either:
- by pressing the "Esc" key,
- or automatically if a command is typed. If this command does not match any script, a beep will signal it.


++ Display of the list of icons in the notification area and of the list of windows of launched applications ++[hdr1]
This feature is, by default, installed with input gestures.

It adds the following scripts:
- Display of the list of icons in the notification area,
- Display of the list of windows of launched applications,
- Display of the list of icons of the notification area or of the windows of the launched applications.


These scripts are placed in the "ADDON_SUMMARY" category of the NVDA "Input gestures" dialog.


+++ Display of the list of icons in the notification area +++[hdr1-1]
This script initially created by Yannick Maillot and Daniel Poiraud was installed using the independent add-on "ListIconesZoneNotification_v1.2.nvda-addon" which must therefore be uninstalled.

Its description is: "Shows the list of buttons on the System Tray "

It is started by the command "KEY_ICONS_List" of the command interpreter. It is the counterpart of the Jaws script "Insert + f11".

No input gesture is assigned to it by default.

It displays a dialog box which contains:
- the list of icons in the notification area,
- the "Single left click" button to trigger a single left mouse click,
- the "Single right click" button to trigger a single right mouse click,
- the "Double left click" button to trigger a double left mouse click,
- the "Cancel" button to close the dialog box and end the script.


Navigation in the dialog box is by "Tab" or upper case + Tab "and in the list with the up and down arrows.

Pressing the "Esc" key closes the dialog box.

In the list of icons, pressing the "Enter" key triggers the pressing of the "Single left click" button.


+++ List of windows of running applications +++[hdr1-2]
The description of this script is: "Display the running application windows's list with opportunity to put one of them on the foreground or destroy it ".

It is the counterpart of the Jaws script "Insert + f10".

It is started by the command "KEY_WINDOWS_LIST" of the command interpreter.

No input gesture is assigned to it by default.

It displays a dialog box which contains:
- the list of all the windows of the launched applications,
- the "Switch to" button to bring the selected window to the foreground,
- the "Destroy" button to close the selected window,
- the "Destroy all" button to close all windows,
- the "Close" button to close the dialog box and end the script.


Navigation in the dialog box is by "Tab" or upper case + Tab "and in the list with the up and down arrows.

In the list, it is possible to select by typing the beginning of the title of the desired window.

Pressing the "Esc" key closes the dialog box.

In the list, windows are marked as maximized or minimized.

Pressing the "Switch to" button or the "Enter" key when you are in the list of windows, closes the dialog box and brings the window of the selected application to the foreground, giving it the focus.

Pressing the "Destroy" button closes the window of the selected application and returns the focus to the updated list of application windows.

Pressing the "Destroy all" button closes all the windows and the dialog box.

+++ Display of the list of icons of the notification area or of the windows of the launched applications +++[hdr1-3]
The description of this script is: "Shows the list of buttons on the System Tray. Twice, Display the running application windows's list with opportunity to put one of ".

By default, the "MAIN_KEY_ICONS_List" input gesture is assigned to it.

No interpreter command is assigned to it.

A simple press of the "MAIN_KEY_ICONS_List" input gesture launches the "Display of the list of icons in the notification zone" script (see above).

Pressing twice launches the script "Displaying the list of windows of the applications launched" (see above).


++ Help for the composition of complex symbols ++[hdr3]
This feature is by default, installed without input gesture.

It adds the following two scripts:
- a script whose description is: "Allow you to copy or type complex symbol ".
- a script whose description is: "Display the list of last used symbols".


These scripts are stored in the "ADDON_SUMMARY" section of the NVDA "Input gestures" dialog.

+++ Script Compose a complex symbol such as an accented vowel, a mathematical symbol +++[hdr3-1]
This script is launched:
- either by the command KEY_COMPLEX_SYMBOL "of the command interpreter,
- or by the "MAIN_KEY_COMPLEX_SYMBOL" input gesture assigned by default.


It displays the "Help for the composition of complex symbols" dialog box made up of:
- the list allowing you to choose one of the categories of symbols,
- the list showing the symbols of the selected category,
- the "Paste" button to insert the selected symbol into the current document,
- the "Copy to clipboard" button to copy the selected symbol to the clipboard,
- the "Manage your symbols" button to add / delete your own categories or symbols
- the "Close" button to close the dialog box.


We move in the dialog box by "Tab" or "Shift + Tab".

Pressing the "Esc" key closes the dialog box.

When you are in the list of categories, pressing the "Enter" or "Tab" key brings the focus to the list of symbols of the selected category.

These symbols are listed in the order of the "symbolCategories.dic" file (see below).


On the other hand, if you are in the list of symbols and a symbol is selected, pressing the "Enter" key causes the "Paste" button to be pressed.

Positioned on a symbol, pressing the "Space" key causes the symbol code to be vocalized in the form: decimal code followed by the spelled hexadecimal code. This can be useful if you want to manually compose the symbol by the Windows command "Alt + 0" followed by the decimal code dialed on the numeric keypad.

Pressing one of the three buttons closes the dialog box.

The "Manage your symbols" button presents the dialog box which offers the possibility of completing the basic categories of the add-on with your own symbols.
This dialog box displays:
- the list of all categories,
- the list of symbols specific to the user for the selected category,
- the "Add a symbol" button to add a symbol in the selected category,
- the "Delete symbol" button to delete the selected symbol,
- the "Add a category" button,
- the "Delete category" button to delete the category (Basic categories cannot be deleted)
- the "Save" button to save all the modifications made and close the dialog box,
- the "Cancel" button to close the dialog box without modification.

The added categories and symbols are stored in the add-on configuration file (NVDAExtensionGlobalPluginAddon.ini located in the NVDA user configuration folder) under the "Categories & Symbols" section and under the subsection corresponding to the NVDA language under which changes have been made.

Each category is a section defined as follows:
- category name,
- list of symbols (the symbol = its description)

The basic categories of the add-on with their symbols are defined in a "symbolCategories.dic" file specific to each language and which is located in the "xxx" folder of the "local" folder of the add-on (xxx being the identifier language,for example "fr" for French).
You can customize this add-on and create your own basic categories.
To do this, simply create in the userConfig folder, a "symbolCategories-xxx.dic" file, saved in "utf-8" encoding, (xx is the language code). In this file, the name of the categories will be defined between square brackets and each symbol as follows:
- the symbol (a single character),
- a tabulation ("Tab" character),
- the description of the symbol (a string of characters).


Empty or comment lines (starting with "#") are accepted.

These files are kept during an add-on update, even if the user asks not to keep their own settings.
The installation of the add-on adds, for each language, the pronunciation of certain symbols found in the basic categories and which NVDA does not have. The" symbols-xx.dic "file in the userConfig folder is either created, be modified to add the new pronunciations.



+++ Script Display the list of the last compound complex symbols +++[hdr3-2]
This add-on stores the last 20 symbols dialed for the current configuration profile.

This script allows them to be displayed and to recompose a commonly used symbol. This avoids going to search for it in its category with the previous script.

This script is started by the command KEY_LAST_USED_COMPLEX_SYMBOL "of the command interpreter. No input gesture is assigned to it by default.

It presents the same kind of dialog box as the previous script without the button to manage its own symbols.

The maximum number of last symbols can be configured with the option "Maximum number of last recorded compound symbols" placed in the "Advanced" category of the "Settings" dialog of the add-on.


++ Information about the application under focus ++[hdr4]
This feature is installed by default without input gesture.

It installs, according to its state of installation, the following scripts:
- announcement of the name of the application file, the name of the add-on loaded as well as the name and status of the configuration profile,
- announcement of the name and version number of the application,


And in any case, the scripts:
- Announcement of the application file name, the name of the active add-on and the name and status of the configuration profile.
- display of information about the application.


These scripts are stored in the "Tools" section of the NVDA "input gestures" dialog.


+++ Announcement of the application file name, the loaded python appModule's name and the name and status of the configuration profile +++[hdr4-1]
The description of this script is: "Speaks the filename of the active application along with the name of the currently loaded appModule python file. Pressing this key twice,speak the name and state of the current configuration profile".

By default, the "MAIN_KEY_CONFIGURATION_PROFILE" input gesture is assigned to it.A single press of the input gesture triggers the basic NVDA script which announces the name of the application file and if there is one, the name of the loaded python appModule's name.

Pressing twice announces the name of the configuration profile and its status.

+++ Announcement of the version number of the application under the focus +++
The description of this script is: "Announce the name and version number of the application under focus".

By default, the "MAIN_KEY_REPORT_NAME_VERSION" input gesture is assigned to it.

The input gesture triggers the announcement of the name and version number of the application placed under focus.


+++ Display information about the application under the focus +++[hdr4-2]
The description of this script is: "Display informations about the focused application".

It is started with the "KEY_APPLICATION_INFORMATIONS" command of the interpreter.

By default, No input gesture is assigned to it.

It displays the "ADDON_SUMMARY - Information" dialog box which presents the following information:
- name of the application file under focus and its version number,
- the name of the triggered configuration profile.
- the name and version number of the active add-on,
- the path of the active add-on,
- the name of the loaded python module if there is one.


+++ Display of the name and version number of the add-on +++[hdr4-3]
The description of this script is: "Announce the name and version number of the add-on activated for the application under focus".

By default, no input gesture is assigned to it, nor any interpreter command.

++ Enhancement of virtual buffer features ++[hdr5]
This feature is installed by default.

It concerns Mozilla Firefox, Microsoft Internet Explorer, Google Chrome, Microsoft Edge (partially) browsers and provides:

+++ New navigation commands +++[hdr5-1]
This add-on adds the following commands for the browse mode:
- "p" to go to the next paragraph,
- Shift + p "to go to the previous paragraph,
- ";" to go to the next main region,
- "uppercase +;" to go to the previous main region,
- "y" to go to the next division,
- "Shift + y" to go to the previous division,
- "z" to go to the next anchor,
- "Shift + z" to go to the previous anchor,
- ":" to go to the next clickable element,
- "shift+:" to go to the previous clickable element.



Except for the first four, these commands are not implemented in the Microsoft Edge browser.

+++ New element types for "NVDA + f7" script +++[hdr5-2]
Basically, the script integrated into NVDA and triggered by the "NVDA + f7" input gesture, allows you to display the "List of elements" dialog box presenting the list of certain elements found in a Web page.
This add-on increases the number of item types that can be chosen and displayed in the title of the dialog,the selected type.

The list of these types becomes:

Basic types:
- Link,
- Title,
- Form Field,
- Button,
- Region.


Types added by the add-on:
- Radio button,
- Paragraph,
- Framework (not in Microsoft Edge),
- Division (not in Microsoft Edge),
- Checkboxes,
- combobox,
- table,
- Quote (not in Microsoft Edge),
- Edit ,
- List,
- List item,
- Anchor (not in Microsoft Edge),
- Graphics,
- Embedded object (not in Microsoft Edge),
- Separator,
- clickable (not in Internet Explorer or Microsoft Edge).


These types are presented as a list instead of a radio button (in the basic version).

A type can be reached by typing the first letter of its label.


At each change of type, the number of elements found is announced or if no element is found, the voice indication "no element" is broadcast.

A repeating beep sound is heard while searching for items.


The status "checked" or not checked "is signaled for the checked boxes.

The "edit" type gives the list of the document's edit zones, and each element is presented vocally as follows:
- announcement of the label of the zone if there is one or "without label" otherwise,
- announcement of "edit zone",
- announcement of the content of the editing area.


Likewise, each form field is presented vocally according to its type.

+++ Scripts for tables +++[hdr5-3]
For Microsoft Internet Explorer, Microsoft Edge, Mozilla Firefox, GoogleChrome browsers, it is possible when the cursor is on a table cell of:
- announce the position of the current cell (input gesture KEY1_CELL_POSITION_REPORT on desktop, KEY2_CELL_POSITION_REPORT on laptop),
- announce the cells of the current line (input gesture "KEY_CURRENT_ROW_REPORT"),
- announce the cells of the current column (input gesture "KEY_CURRENT_COLUMN_REPORT"),
- move the cursor to the cell of the following row, same column and read the cells of this row ("KEY_NEXT_ROW_REPORT" input gesture),
- move the cursor to the cell of the previous row, same column and read the cells of this row (input gesture "KEY_PREVIOUS_ROW_REPORT"),
- move the cursor to the cell of the next column, same row and read the cells of this column (input gesture "KEY_NEXT_COLUMN_REPORT"),
- move the cursor to the cell of the previous column, same row and read the cells of this column (input gesture "KEY_PREVIOUS_COLUMN_REPORT").
- go to the first cell of the line (input gesture KEY_MOVE_FIRST_CELL_ROW),
- go to the last cell of the line (input gesture KEY_MOVE_LAST_CELL_ROW)
- go to the first cell of the column (input gesture KEY_MOVE_FIRST_CELL_COLUMN),- go to the last cell of the column (KEY_MOVE_LAST_CELL_COLUMN input gesture).


The last four scripts are removed from the extension for versions greater than or equal to 2022.2 because they are now provided by NVDA.

All of these scripts are stored in the "Table" category in the tree view of the NVDA "input gestures" dialog.

This add-on also moves NVDA base scripts that used to be under the "Miscellaneous" category into this category. Those are:
- go to previous column: "NVDA + control + left arrow",
- go to next column: "NVDA + control + right arrow",
- go to previous row: previous "NVDA + control + up arrow",
- go to next row: "NVDA + control + down arrow",


+++ Announcement of the document address +++[hdr5-4]
The input gesture "KEY1_DOCUMENT_ADDRESS", (desktop computer) or "KEY2_DOCUMENT_ADDRESS" (laptop) typed in Mozilla FireFox, Microsoft Internet Explorer, Microsoft Edge or Gooble Chrome browsers, announces the address (URL) of the document. With a double press, this address is copied to the clipboard.

+++ Loop navigation +++[hdr5-5]
In browse mode, the search for the next or previous item stops at the end or the beginning of the document.

This add-on adds, as an option, the possibility of cyclically browsing the document, that is to say:
- the search for the next element continues, descending from the start of the document if the end of the document is found,
- the search for the previous element continues by going up by the end of the document if the beginning of the document is found.


The passage through the beginning or the end of the document is signaled by a sound and a voice message.

The "Loop navigation" option in the "NVDA Add-ons" category of the add-on's "Settings" dialog allows you to enable or disable this operation.

This option is only shown if the "Extend virtual buffer functionality" feature is installed.

By default, this option is not checked. The basic operation of NVDA is retained.
++ Announcement of the function associated with the "copy", "Paste" style editing commands ++[hdr7]
This feature is installed by default.

The functions triggered by the shortcuts "control + v", "control + c", "control + x", "control + z" are not vocalized by NVDA, this extension takes care of them.

No check on the result of the function is done.

But:
- for the shortcuts "control + c", "control + x", the absence of text selection is indicated in the trees and the lists.
- for the "control+c" shortcut, the "copied" message is only pronounced if the content of the clipboard has changed.
- for the "control+v" shortcut, the empty state of the clipboard is signaled.


It is strongly advised not to install extensions that provide the same kind of functionality.

If this feature is installed, the following scripts are installed.
+++ Add selected text to clipboard +++[hdr7-1]
This feature adds the script that allows you to add the selected text to the clipboard.

This script is installed without input gesture, but it is possible to assign one to it using the NVDA "Input gestures" dialog. Its description is "Add, to clipboard, selected text" and is placed in the "ADDON_SUMMARY" category.

All the parameters used for the script are located in the "Clipboard" group of the "Keyboard" category of the add-on dialog which presents the settings of the current configuration Profile.

It is started using the "KEY_ADDING_TO_CLIP" interpreter command.

Following the command, the selected text is added to the content of the clipboard, either after or before depending on the state of the "Add to clipboard before"checkbox.

It is possible to place a separator text between the text blocks. This text can be configured using the Edit Text field used as a separator between the contents added to the clipboard ".


A confirmation request will be displayed before proceeding with the addition if the "Ask confirmation before adding to the clipboard" checkbox is checked.

Note: this script is taken from the "ClipContentsDesigner" add-on (Authors Noelia, Abdel) which also provides other interesting features regarding the clipboard. It was put in this add-on on request of users who wanted at the same time the announcement of the functions "copy" and "paste".

+++ Report text on Windows clipboard +++[hdr7-2]
This script replaces the base NVDA script ("NVDA+c") to complete it by telling the user who ran the command that:
- the clipboard is empty,
- in case there is no text in the clipboard, the clipboard may not be empty.


the number of characters read is no longer limited to 1024.

This maximum number can be configured using the "Maximum reported characters" choice in the "Clipboard" group of the "NVDA enhancements" category.

+++ Empty the clipboard +++[hdr7-3]
This script is installed without a input gesture, but it is possible to assign one using NVDA's "Input gestures" dialog.

Its description is "Empty the clipboard" and is placed under the "System status" category.

Its function is to completely erase the contents of the Windows clipboard. Attention, this does not concern the history of the Windows clipboard.

It is launched using the "KEY_CLEAR_CLIP" interpreter command.

++ Announcement of the selected folder in the "Open", "Save", "Save as" style dialog boxes ++[hdr8]
This feature is installed by default without input gesture.

It adds, for the dialog boxes of the style "Open", "Save", "Save as", "Find in",scripts which allow to know the name and the path of the folder which is selected to define the location where the file will be searched where to save.

These scripts are placed in the "ADDON_SUMMARY" category of the NVDA "input gestures" dialog.
Those are:
- "report the name of current selected folder in the open or Save dialog box. Twice: report full path": input gesture "MAIN_KEY_SAY_CURRENT_FOLDER" which is assigned to it by default.
- "report the name of current selected folder in the open or Save dialog box": " KEY_SAY_CURRENT_FOLDERNAME" command from the interpreter.
- "report the full path of current selected folder in the open or Save dialog box": "KEY_SAY_CURRENT_FOLDERPATH"command from the interpreter.


No input gesture is associated with the last two scripts, but it is possible to associate one to them using NVDA's "input gesture" dialog.

Please note, these scripts only work in dialog boxes conforming to the Windows standard.


++ NVDA logs ++[hdr9]
This feature is by default, installed without input gesture.

It adds the scripts:
- management of NVDA logs,
- Opening of NVDA logs.


These Scripts are stored in the "Tools" category of the NVDA "input gestures" dialog.

+++ Management of NVDA logs +++[hdr9-1]
The description of this script is: "Open a dialog to manage NVDA logs".

It is started using the "KEY_LOG_VIEW" command of the interpreter. No input gesture is assigned to it by default.

This script displays the "NVDA Log Management" dialog box showing:
- a button to open the current NVDA log,
- a button to open the old NVDA log,
- a button to copy the path of the current NVDA log to the clipboard,
- a button to copy the path of the old NVDA log to the clipboard,
- the "Close" button to close the dialog box.


The log is not directly opened. It is previously copied to a temporary "NVDALog.txt file" or "oldNVDALog.txt".
This temporary file then opens in the program associated with the .txt extension. Default is notepad.
On Windows 11, for some unknown reason, opening this file like NVDA's "contributors.txt" causes an error.
This only happens with an installed version of NVDA. Portable versions are not affected.
To solve this problem pending a future correction from Microsoft, you must ask Windows to launch NVDA in administrator mode, as follows:
- go to the NVDA folder and to the "nvda.exe" file.
- open the properties of this file.
- in the "Compatibility" tab, check the box "Run this program as an administrator".
- confirm with "OK".


+++ Opening NVDA logs +++[hdr9-2]
The description of this script is: "Open current NVDA log file. Pressing this key twice, open the old NVDA log file. Pressing third, copy current log path to the clipboard".

It is launched using the "MAIN_KEY_LOG_VIEW" input gesture which is assigned to it by default.

A simple press triggers the opening of the current NVDA log.

A double press opening the old log.

A triple press, copying the path of the current log to the clipboard.



The journal is not directly opened. It is previously copied to a temporary NVDALog.txt file.
This temporary file then opens in the program associated with the .txt extension. Default is notepad.


++ Speech history ++[hdr10]
This feature is installed by default without input gesture.
In order to be able to listen to voice announcements that are poorly understood or heard badly, this add-on records a limited history of speech strings sent to the synthesizer.
The number of records is limited to 200.

To listen to these recordings again, the following scripts, placed in the "Speech" category of the NVDA "input gestures" dialog, are provided by this functionality:
+++ Announcement of the previous recording +++
This script is started using the input gesture, "MAIN_KEY_PREVIOUS_RECORD" assigned by default.

The input gesture triggers the announcement of the previous recording compared to the last announced recording.
+++ Announcement of the next recording +++
This script is launched using the input gesture, "MAIN_KEY_NEXT_RECORD" assigned by default.

The input gesture triggers the announcement of the next recording compared to the last announced recording.

+++ Re-announce the last recording announced +++
The description of this script is: "Report current record of the speech history and copy it to clipboard. Twice: display speech history".

This script is started using "MAIN_KEY_CURRENT_RECORD" input gesture assigned by default.

A simple press triggers the announcement of the last recording.

A double press, triggers the copy of the recording to the clipboard.

A triple press, displays the entire history.

+++ Show speech history +++[hdr10-1]
The description of this script is: "display speech history records".

This script is started using the "KEY_DISPLAY_SPEECH_HISTORY" command of the interpreter. No control gesture is assigned to it by default.

It presents the "Speech history" dialog box which lists these recordings in descending order of their age. A button is used to copy the selected recording to the clipboard.

By default:
- the records are numbered. This numbering can be deactivated by the option "Number the records" in the "Speech history" grouping of the "NVDA enhancement" category of the "Settings" dialog.
- the records are presented in descending order. The "Display records in ascending order" option for this same grouping allows you to display them in reverse order.


++ Keyboard keys renaming ++[hdr12]
This feature is installed by default.

It allows you to rename certain keyboard keys as "Caps lock" or "Numeric lock" using a dialog box which presents:
- in a list, the keyboard keys with their label defined in NVDA,
- The "Modify" button which allows you to modify the label of the key selected in the list and enter a replacement caption using a classic input dialog box.


When a replacement label is defined for the selected key, the read-only edit box, reachable by "Tab", displays this replacement label. This label is announced when the key is focused.

The "Delete" button allows you to delete this replacement label.

It is also possible to delete this label by entering an empty or full string in the input box.

The "Delete all" button allows you to delete all the replacement labels to return to the basic labels provided by NVDA.

The "OK" button is used to apply the overrides and to save the keyboard keys and their replacement label in the add-on configuration file in the "RedefinedKeyLabels" section and the corresponding NVDA language subsection (" fr "for example for French). It is thus possible to have key renames for different languages.


To display this dialog, three possibilities:
- by selecting and activating the item "Keyboard keys renaming" of the "ADDON_SUMMARY" submenu,
- with the "KEY_RENAMING" command of the interpreter,
- with the script "Display keyboard keys renaming dialog", provided without input gesture. A gesture can be assigned to it using the NVDA "input gesture" dialog.


It is possible to not install this feature by selecting, in the "Installed features" category and for the "Keyboard keys renaming" feature, the "Do not install" status.


++ Selective announcement of command keys ++[hdr13]
This feature is installed by default.

NVDA allows the command keys to be spoken by voice using the "Speek command keys" option located in the "Keyboard" category of the NVDA "Settings" dialog or by the "NVDA + 4" input gesture.

This functionality provides, by configuration and using a dialog box, the possibility of:
- do not announce certain command keys when the "Speek command keys" option is checked,
- announce certain command keys when the "Speek command keys" option is not checked.


To display this dialog, three possibilities:
- by selecting and activating the item "Command selective announcement" in the "ADDON_SUMMARY" submenu,
- using the "KEY_SELECTIVE_ANNOUNCEMENT" command of the interpreter,
- using the script "Display command selective announcements dialog", provided without input gesture. An input gesture can be assigned to it using the NVDA "input gestures" dialog.


The dialogue presents:
- a checkbox to choose for which mode,the keys have been configured,
- the list of possible keys,
- the list of possible modifier key combinations with the additional "NVDA", "Alt", "Control", "Shift", "Windows" keys.


Pressing the space bar checks or unchecks the selected key or combination.

If the "Speek command keys" box in the dialog box is not checked, checking a key will cause that key to announce anyway when NVDA is configured not to announce them.

The list of modifier key combinations is then accessible and all the elements in this list are checked by default.

To prevent the key typed with a particular combination from being announced, it suffices to uncheck this combination.

If the "none" item in the combination list is checked, the key will be announced even when pressed without a modifier key combination.

On the other hand, if the "Speek command keys" check box is checked, checking a key prevents this key from being announced when NVDA is configured to announce them.

The list of modifier key combinations is then accessible and all the elements of this list are checked by default. This means that the key typed with or without a combination will not be announced.

The action of unchecking a combination then makes it possible to announce the key with this combination.

The "none" element in the list of combinations makes it possible not to have the same key announced without a combination of modifier keys.

The "Uncheck all" and "Check all" buttons allow you to uncheck or check all the elements in the list of modifier key combinations.

The first item "any key with modifier key combination" in the list of keys allows, without designating a particular key, to select a set of modifier key combinations. Any key typed with one of these combinations will be announced or not, depending on the configuration mode chosen.

The "OK" button saves the choices made for the current configuration profile, while the "Cancel" button forgets them.

In the lists, the "F2" key and the "shift + F2" key combination allow you to move respectively to the next or previous checked item.

It is possible to not install this functionality by selecting, in the "Installed functionalities" category and for the "Selective announcement of command keys" functionality, the "Do not install" status.

++ Minute timer ++[hdr14]
This feature is installed by default.

It allows you to start a timer for a programmable duration.

When the timer expires, a dialog box appears displaying a programmable announcement and the emission of a ringtone.

It installs a script which starts:
- either by the "KEY_MINUTE_TIMER" command of the command interpreter,
- or by the "MAIN_KEY_MINUTE_TIMER" input gesture assigned by default.


If the timer is stopped, the script displays the "Launch timer" dialog box which presents:
- the zone for editing the duration of the timer (in minutes),
- the edit zone of the announcement displayed at the end of the timer,
- the list to choose the time to be warned before the timer expires,
- the "Ring options" button to configure the number of rings and the time between rings.


The duration, the announcement and the time to be warned before the timer expires are recorded each time the timer is started and displayed by default the next time the timer is started.

If the timer is in progress, the script then displays the "Timer in progress" dialog box allowing you to know the remaining duration of the timer and possibly to stop the timer.

The duration is refreshed every 5 seconds and is announced when the focus is in the edit zone (read-only) displaying it.

This dialog box closes automatically when the timer expires.

++ NVDA restarting ++[hdr15]
This feature is not installed by default.

It installs a script that allows restarting NVDA in debug logging level without modifying NVDA configuration.

The description of this script is: "Restart NVDA. Twice: restart with log levelset to debug".

It is placed in the "Miscellaneous" category of the NVDA "input gestures" dialog.

The "MAIN_KEY_RESTART_NVDA" input gesture is assigned to it by default.

A simple press of this gesture triggers a restart of NVDA with the logging level configured in the general preferences.

Double pressing of this input gesture restarts NVDA with the debug logging level without changing the logging level configured in NVDA general preferences.


++ Displaying of visible elements of the object in the foreground ++[hdr16]
By default, this feature is installed with input gesture.

It installs two scripts stored in the "System focus" category of the NVDA "input gestures" dialog:

+++ Display of visible elements of the object under focus +++
The description of this script is: "Display the list's visible items making up current foreground object".

It is started using the "KEY_OBJECTS_LIST" command of the interpreter.

No input gesture is attributed to it.

The script starts searching for these items. This can take a long time. An audible signal every two seconds is emitted during this search.

To limit this search time, limits are put in place for certain types of elements:
- the maximum number of rows in a table is set at 40,
- the number of elements of a tree structure is fixed at 40,- the maximum number of elements in a list is fixed at 40,
- the elements making up a document are not taken into account, nor those of a table, a tree structure and a list where the number of elements exceeds 500.


When the search is complete, the elements are displayed in the "List of visible elements making up the foreground object" dialog box, according to their type.

This dialog box presents:
- the checkbox to choose whether the elements without a label or description must be taken into account or not (by default, the unlabeled elements are not taken into account),
- the list of the types of elements available,
- the list of elements for the selected type,
- the button to make a left mouse click on the selected element (default button when you are in the list of objects),
- the button to right click on the selected element,
- the button to bring the NVDA browser object and the mouse pointer to the selected element,
- the button to exit the dialog.


In the list of elements, it is possible to change the type of objects to list without leaving the list:
- either by using the left or right direction arrows,
- or by typing "control + upper case + the first letter of the type of object desired".


Also in this list, it is possible to reach an element by typing the first letters of its label.

For an element of type:
- button or check box: the state of the element is indicated.
- edit box: read-only status is indicated.


+++ Announcement or display of visible elements of the object under focus +++
The description of this script is: "Reads all controls in the active window. If pressed twice: display the list's visible items making up it".

It is launched using the "MAIN_KEY_OBJECTS_LIST" input gesture which is assigned to it by default.

A single press launches the basic NVDA script which announces all objects of the object in the foreground.

Pressing twice launches the previous script "Display of visible elements of the object in the foreground".


++ Fast voice profile switching ++[hdr17]
This feature is installed by default without input gesture.

It allows you to quickly change voice profile by giving the possibility of memorizing up to 8 voice profiles and quickly selecting one of these voice profiles.

A voice profile is defined by:
- the voice synthesizer used and its configuration voice parameters (such as "voice", "volume", "speed", ...),
- NVDA voice configuration parameters (such as "Punctuation and symbol level", "Say uppercase after uppercase", ...).


It installs the following scripts under the "Voice Profile Switching" category of the NVDA "input gestures" dialog:

+++ Management of voice profile selectors +++[hdr17-1]
The description of this script is: "Display dialog to manage voice profile selectors".

It can be activated by:
- either using the "KEY_MANAGE_VOICE_PROFIL" command of the interpreter,
- or using the "MAIN_KEY_MANAGE_SELECTOR" input gesture which is assigned to it by default.


This script displays the " Voice profile selectors's management of the ProfileName configuration profile" dialog box (where ProfileName is the name of the triggered configuration profile).

This dialog box is used to manage the selector-voice profile association and presents:
- the "Use the associated selectors under the normal configuration profile" check box,
- the "selectors" list,
- the "Activate" button,
- the button "Associate the voice profile",
- the "Edit voice profile" button,
- the "Release the selector" button,
- the "release all selectors" button,
- the button "Information on the voice profile",
- the "Close" button.


The "Selectors" list shows the list of free selectors or those associated with a voice profile. The associated selectors are:
- those which have been associated under the current configuration profile (its name is indicated in the title of the dialog),
- those which have been associated under the normal configuration profile if the checkbox "Use the associated selectors under the normal configuration profile" is checked. The indication "normal configuration" is then indicated for these selectors.


When the selector is indicated as "free", the "Associate voice profile" button allows you to associate the current voice profile with this selector. This button brings up a dialog box allowing you to give a name to this voice profile. A default name is proposed. The "Default" button allows you to return to this proposal.

When a selector is already associated with a voice profile, it is then possible:
- activate this voice profile with the "Activate voice profile" button: the profile becomes the current voice profile and the box closes.
- associate the current profile with the selector using the "associate voice profile" button. This profile then replaces the voice profile associated with this selector,
- modify the name of the voice profile with the "Modify voice profile" button,
- break the association between the selector and the voice profile with the "Release the selector" button.
- break all associations with the "Release all selectors" button.


If the selected selector is an associated selector under the normal configuration profile, then it is not possible to release it, but it can be associated with the current profile.

Only the selectors associated under the current configuration profile can be released.

To quickly change voice profile, the "Voice profile switching" mode is set up.

To activate or deactivate this mode, the "KEY_VOICE_PROFIL_SWITCHING" command of the interpreter must be typed.

This mode activated,the right or left arrows are used to move to the first next or previous selector associated with a voice profile and thus define the voice profile associated with this selector as the current voice profile.

The selectors taken into account are the selectors from the "Selectors" list which are associated with a voice profile.

+++ "Voice profile switching" mode +++[hdr17-2]
To quickly change voice profile, the "Voice profile switching" mode is set up and a script is used to activate or deactivate it.

The description of this script is: "Activate or deactivate Voice profile switching mode".

To run this script, two possibilities:
- either by typing the "KEY_VOICE_PROFIL_SWITCHING" command from the interpreter,
- or using the "MAIN_KEY_TOGGLE_VOICE_PROFIL_SWITCHING" Input gesture (not installed by default).


When this mode is activated, the right or left arrows are used to move to the first next or previous selector associated with a voice profile and thus define the voice profile associated with this selector as the current voice profile.

The selectors taken into account are the selectors from the "Selectors" list which are associated with a voice profile.
+++ Choice of previous voice profile selector +++
The description of this script is: "Go backward to the first selector associated to a voice profile and set this voice profile as current voice profile".

It is launched using the "MAIN_KEY_PREVIOUS_VOICEPROFILE" input gesture which is assigned to it by default.

The script searches for, in the "Selectors" list, the first selector preceding the current selector associated with a voice profile. Then he positions this voice profile as the current voice profile.


+++ Choice of the next voice profile selector +++
The description of this script is: "Go to forward to the first selector associated to a voice profile and set this voice profile as current voice profile".

It is launched using the "MAIN_KEY_NEXT_VOICEPROFILE" input gesture which is assigned to it by default.

The script searches for, in the "Selectors" list, the first voice profile selector following the current selector associated with a voice profile. Then he positions this voice profile as the current voice profile.

+++ Choice of voice profile selector by number +++
8 scripts are installed.
The description of these scripts is: "Set selector x as current selector and Sets , if possible, it associated voice profile as current voice profile" (where x is the number of the selector).

Each script is launched using the "MAIN_KEY_VOICEPROFILE_SELECTOR" input gesture assigned by default.

The script selects the selector x and if it is associated with a voice profile, positions this voice profile as the current voice profile.

+++ Report or display of current speech settings +++[hdr17-6]
The following 3 scripts allow you to know the current speech settings without having to use the "Speech" NVDA menu.

They are stored in the "Speech" category of the "Input Gestures" NVDA dialog and are installed even if the "Voice Profile Switching" feature is not installed.

No input gesture is associated with them, but it is possible to assign one to each.

Their descriptions are:
- "Report the current speech settings": is started with the "KEY_REPORT_SPEECH_SETTINGS" command from the command interpreter.
- "Display the current speech settings": is started with the "KEY_DISPLAY_SPEECH_SETTINGS"commond from the command interpreter.
- "Report the current speech settings. Press twice: display them": no interpreter command is associated with it.


+++ Autosave voice settings when switching profiles +++[hdr17-7]
Current voice settings can be automatically saved for the current selector when switching voice profiles.

The purpose of this is to avoid having to manually reassociate the vocal profile to the same selector if vocal parameters have been modified, such as for example the rate, the volume and to lose these modifications by switching to another vocal profile if this is not done.

Obviously, the current selector must be associated with a voice profile. If not, there will be no recording.

This feature is configurable and is not enabled by default.

To activate it, you must check the option "Automatically save current voice settings for the current selector before switching" which is in the "Advanced" category of the global settings of the add-on.

++ NVDA and modifier keys's remanence ++[hdr18]
This feature is not installed by default.

It allows to make the NVDA keys ("Insert" of the normal or extended numeric keypad, "Caps Lock" key) and the modifier keys ("shift", "control", "left Alt", "Control right Alt" , "Windows") to be made peersistent.

The objective being to be able to use only one finger, for example, to compose a input gesture requiring the pressing of several keys.

It places a "Keys's remanence" grouping in the "Keyboard" category of the addd-on's "Settings" dialog.

To activate or deactivate keys's remanence, all you have to do is dial one of the following keyboard key sequences:
- "Right shift", "Right control", "Right shift",
- "left shift", "left control", "left shift".

Keys's remanence can be enabled automatically at NVDAstart by checking the "Activate remanence at NVDA's start" check box in the "Keys persistence" grouping.The activation or deactivation of afterglow is signaled by voice.

When remanence is activated, pressing one of the NVDA or modification keys triggers a timeout and the key is memorized.
This time delay can be configured using the "Remanence's delay (in milliseconds)" combobox in the "Keys' remanence" grouping.

It is also possible to limit the remanence to the single "NVDA" key by checking the "Only NVDA key in remanence" check box located in the same grouping. By default, this box is not checked and all modifier keys are sticky.

The start and end of this persistence is signaled by a beep which can be deactivated using the following check boxes in the "Key persistence" category:
- "Play sound at the start of remanence",
- "Play sound at the end of remanence".


They are checked by default.

During this time delay, any further press on one of these keys restarts the time delay and this new key is also memorized, but no beep is emitted.

Pressing any other key on the keyboard executes the input gesture made up of the combination of all the keys memorized with this last key.

Each time this last key is pressed again during the timeout, the input gesture will be executed again.

If this key is typed out of time, it is executed alone and the memorized keys are forgotten.

Warning:
You have to wait for the end of afterglow to have any new key treated individually. For example: "Alt" to display a menu then expand the menu items.

It is however possible to stop the remanence before the end of the time delay, by re-entering the last key in remanence.


+++ Specific remanence for the gmail.com site +++[hdr18-1]
This remanence is specifically set up for the gmail.com site and is only active in the "https://mail.google.com/mail/#i" page.

It is not active by default. A checkbox "Special remanence for Gmail.com" is provided in the "Keystroke persistence" grouping.

In this page, it is possible to type shortcuts to launch commands but some of them chain two letters. In particular, the letters "g", "h", "*" must be followed by another letter.
This sequence must be fast enough to trigger the execution of the associated command.
This is problematic for people who do not have sufficient dexterity.

The objective of this remanence is therefore to retain the first letter while waiting for the second to be struck.

When the first letter is struck, a time delay is started (a dull beep is heard) and the letter is stored.

Typing the second letter within the configured remanence delay will send both letters to the browser and the timeout is stopped.If no new letter is entered, the first letter is sent to the browser at the end of the time-out (a high-pitched beep is audible).

In order for NVDA to send the letters to the browser, it is necessary to switch to form mode first.



++ Computer shutdown ++[hdr19]
This feature cannot be uninstalled.

It installs a script whose description is: "Display the dialog to shutdown, restart or hibernate".

It is started using the "KEY_SHUTDOWN" command of the interpreter.
This script displays a dialog consisting of the following elements:
- a button to shut down the computer,
- a button to restart the computer,
- a button to put the computer in hibernation,
- a checkbox for, if it is checked (default state), requesting the closing without warning of all the applications launched when one of the first two buttons is pressed,
- an edit field to define the waiting time before putting the computer to sleep, shutting down or restarting,
- the "Cancel" button to close the dialog box.


This feature also installs the scripts corresponding to the functions of the three buttons, but with the following behavior:
- closing without warning all launched applications for shutdown or restart,
- shutdown, restart or hibernation is immediate.


If a non-zero waiting time is configured, a dialog box then presents the waiting time remaining before putting the computer to hsleep, shutting down or restarting.

The "Cancel" button or the "Escape" key is used to interrupt the request.

Reporting of remaining wait time respects NVDA's "tracking progress bars" option.

The "Announce the remaining waiting time" button allows you to read the waiting time displayed in the dialog box.

All scripts are placed in the "ADDON_SUMMARY" category of the NVDA "Input gestures" dialog, but no gestures are assigned to them.

++ Management of user input gestures ++[hdr20]
This feature cannot be uninstalled.

Basically, NVDA allows you to add or remove input gestures using the "Input gestures" dialog. But there is no way to know which gestures are added or removed by the user.

This is what this functionality wants to meet.

To do this, it adds the script whose description is "Displays the dialog to manage the input gestures configured by user" and placed in the "ADDON_SUMMARY" category of the "input gestures" dialog of NVDA.

It is started using the "KEY_USER_INPUT_GESTURE" command of the interpreter. No control gesture is assigned to it by default.

This script displays an NVDA "input gestures" style dialog by selecting only the input gestures deleted or modified by the user.

The dialogue presents:
- the classic tree structure which presents the control gestures by category and each script by its description,
- a "Delete" button (active when a gesture is selected) to cancel the addition or deletion of the selected gesture,
- a button to cancel all additions or deletion of input gestures.


input gestures removed from a category are shown with the description: "input gestures removed".

As it is not possible to know the category and description of a deleted input gesture or of an added input gesture associated with a script of an add-on that is not activated or not installed at the time of the display of the dialogue, this gesture is presented like this:
- the category is named: "name of the python module". Name of the python class "(for example: appModules.notepad ++. editWindow.EditWindow),
- the description of the added input gestures is named: "name of the python script" (for example: goToPreviousBookmark).


As for the classic "input gestures" dialog, it is only by pressing the "OK" button that all gesture deletions will be taken into account.

Cancellation of all changes using the "Delete all" button is subject to confirmation. Upon acceptance, all changes are canceled and the dialogue closes.


++ Volume control ++[hdr21]
By default, this feature is installed without input gesture.

It can only work under Windows 10 operating system.

If it is installed with or without a input gesture, it places the "Volume control" grouping in the "Computer" category of the "Settings" add-on dialog.

It installs the following scripts stored under the "Volume control" category in the "input gestures" NVDA dialog:

+++ Manually set main audio and NVDA audio stream +++[hdr21-1]
This script is launched:
- either using the "KEY_VOLUME_ON" command of the interpreter,
- or using the "MAIN_KEY_VOLUME_ON" input gesture assigned by default.


It sets the volumes of the audio output device that NVDA uses and that of the audio stream from NVDA and forces the levels of each to the values of the undo levels configured in the "Sound Control" group of the "Computer" category of the settings. the extension.

+++ Mute or establish the volume of the audio stream of the application placed under the focus +++[hdr21-2]
This script is launched:
- either using the "KEY_TOGGLE_MUTE" command from the command interpreter,
- or using the "MAIN_KEY_TOGGLE_MUTE" input gesture assigned by default.


This command mutes the volume of the audio stream of the focused application if it is established or restores it if it is muted.

+++ Modify the volume of the audio stream of the application under the focus +++[hdr21-3]
These scripts are used to increase, decrease or fix the volume of the audio stream of the focused application.

They are installed without input gestures. But it is still possible to assign them with the "input gestures" dialog.

They are started using the following interpreter commands:
- "KEY_APP_VOLUME_UP" or "KEY_APP_VOLUME_DOWN" to increase or decrease the volume,
- "KEY_APP_VOLUME_MAX" or "KEY_APP_VOLUME_MIN" to maximize or minimize the volume.
- a number from 1 to 9 to set the volume level at 10%, 20%, 30%, ..., 90% of the main volume.


These commands, unlike the other interpreter commands, can be repeated without having to restart the interpreter. The interpreter is always active.
Once the volume level is reached, press the "Escape" key to exit the interpreter.

The increase or decrease in volume is done in steps.It is possible to adjust the size of these steps in the parameters of the add-on under the "Computer" category, "Volume control" grouping, by choosing the size of the step.

Size 1 is the smallest step, size 20 is the largest step. The size is set to 5 by default.

By default, the app volume level cannot exceed the master volume level. But this limitation can be overridden if the option "Increase speakers volume if necessary" is checked. This option can be found in the "Volume modification" group of the "Computer" category of the global settings of the extension.



+++ Modify the volume of NVDA +++[hdr21-8]
These scripts allow you to increase, decrease, or fix the volume of NVDA.

They are installed without input gestures. But it is still possible to assign them with the "Input gestures" dialog.

They are launched using the following interpreter commands:
- "KEY_NVDA_VOLUME_UP" or "KEY_NVDA_VOLUME_DOWN" to increase or decrease the volume,
- "KEY_NVDA_VOLUME_MAX" or "KEY_NVDA_VOLUME_MIN" to maximize or minimize the volume,
- "upper case + a number from 1 to 9" to set the NVDA volume level to 10, 20, 30, ..., 90 percent of the main volume.


These commands, unlike other interpreter commands, can be repeated without having to restart the interpreter. The interpreter is always active.

Once the volume level is reached, press the "Escape" key to exit the interpreter.

The increase or decrease in volume is done in steps. It is possible to adjust the size of these steps in the parameters of the extension under the category "Computer", group "Sound control", by choosing the size of the step.
Size 1 corresponds to the smallest step, size 20 to the largest step. By default, the size is set to 5, which corresponds to 5 steps of varying the volume in the Windows mixer.

NVDA volume cannot fall below the configured recovery threshold.

By default, it cannot be greater than the primary volume, but this limitation can be overridden if the option "Increase speakers volume if necessary" is checked. This option can be found in the "Volume modification" group of the "Computer" category of the global settings of the extension.

+++ Modify main volume +++[hdr21-4]
These scripts allow to increase, decrease, or fix the main volume of the audio output device used by the application under focus (including NVDA) or the Windows default one if the application under focus does not use one .

They are installed without input gestures. But it is still possible to assign them with the "input gestures" dialog.

They are started using the following interpreter commands:
- "KEY_MAIN_VOLUME_UP" or "KEY_MAIN_VOLUME_DOWN" to increase or decrease the volume,
- "KEY_MAIN_VOLUME_MAX" or "KEY_MAIN_VOLUME_MIN" to maximize or minimize the volume,
- "control + a number from 1 to 9" to set the main volume level at 10, 20, 30, ..., 90,


These commands, unlike the other interpreter commands, can be repeated without having to restart the interpreter. The interpreter is always active.

Once the volume level is reached, press the "Escape" key to exit the interpreter.

The increase or decrease in volume is done in steps. It is possible to adjust the size of these steps in the settings of the add-on under the "Computer" category, grouping "Sound control", by choosing the size of the step.
Size 1 is the smallest step, size 20 is the largest step. By default, the size is set to 5, which corresponds to 5 steps of varying the volume in the Windows mixer.

The primary volume cannot fall below the configured recovery threshold.


+++ Return to previous level +++[hdr21-5]
When using the preceding commands, the volume level is saved before each command is executed, for the audio device, for NVDA, and for each application.

To return to this level, the following commands are available:
- "KEY_MAIN_VOLUME_PREVIOUS_LEVEL": to reset the volume level of the last audio device used to the previous level.
- "KEY_APP_VOLUME_PREVIOUS_LEVEL": to reset the volume level of the application under focus to its previous level.


The previous level is also saved when these commands are executed.


These records are not kept when restarting NVDA.

+++ Announcement of level changes +++[hdr21-6]
Volume level changes are announced by default. The name of the audio output device is also announced on the first volume change for that device.

But it is possible to disable this announcement using the "Announce volume changes" option in the "Volume change" group of the "Computer" category.

+++ Automatically restore main sound and NVDA when plugin loads +++[hdr21-7]
This feature allows you to restore, when loading this add-on, the volume of the NVDA audio source and that of the audio output device it uses by setting the level of each to a value defined by configuration in the event that it is lower than the minimum threshold defined by configuration.

For this, the "Sound control" group of the "Computer" category of the "Parameters" dialog of the add-on, presents the following configuration elements:
- the checkbox "Automatically set the main sound and NVDA when loading the add-on" which enables or disables this option,
- the restoration threshold of the main volume below which its level will be automatically restored,
- the level of the main volume to restore,
- the recovery threshold of the NVDA volume below which its level will be restored (as a percentage of that of the main volume),
- the volume level of NVDA to restore (as a percentage of the main volume).


When launched, this add-on verifies that the primary volume and the NVDA volume are above the recovery threshold configured for each.

If this is not the case, this add-on then fixes the volume level to the value of the level to restore configured.

When installing this extension, the current NVDA volume levels and the audio output device used by NVDA are taken into account to set the values of the levels to be restored.


+++ Copy date and time to clipboard +++[hdr24-1]
The description of this script is: "Copy date and time to clipboard".
This script is stored in the "System Status" category of the NVDA "input gestures" dialog.

It is started using the "KEY_COPY_DATETIME" command of the interpreter.
No input gesture is attributed to it.


As its description indicates, it allows you to copy the date and time to the clipboard.


+++ Script to replace the base script "NVDA + f12" +++[hdr24-2]
The extension installs a script whose description is: "Reports the current time. Twice, reports the current date. Third: copy date and time to the clipboard".

This script is stored in the "System status" category of the "input gestures" NVDA dialog.

No interpreter command is associated with it.

If the extension's install status is "Install", this script replaces the NVDA script and is started using the "NVDA + f12" input gesture.

Otherwise no input gesture is assigned to it, but it is still possible to assign it using the NVDA "input gestures" dialog.

This script allows:
- at the first press of the gesture: the announcement of the current time.
- the second press: the announcement of the current date.
- on the third press: copy of the current date and time to the clipboard.


It also brings:

++++ Announcement of the hour independent of the punctuation level ++++
The basic input gesture "NVDA + f12" gives the time with a simple press, but the time is not announced in the same way depending on the Level of punctuation and symbols selected in the voice parameters.

This script corrects this small flaw by announcing the time with the Level of punctuation and symbols forced to "None" without modifying the level defined in the "Speech" category's parameters.

++++ Announcement of the time with seconds ++++
By default, NVDA's input gesture "nvda + f12" announces the time without the seconds.

This script offers the possibility of announcing the time in seconds.

All you have to do is check the "Report windows clock's time with seconds" checkbox in the "Computer" category of the add-on's Settings dialog. This option is not checked by default.

This option is not present if the installation status of the feature is "Do not install".


++ Emulation of the "Applications" key ++[hdr25]
To compensate for the absence of the "Applications" key on some computers and not knowing whether the "upper case + f10" shortcut fulfills the same function, the add-on installs a script without a input gesture in the "Emulated keys of the keyboard" category system "with the description"Emulate key press: applications".

To use it, all you need to do is assign it a input gesture or a keyboard key that is rarely used, such as the "print screen" key, the "Pause" key.

++ Close all windows ++[hdr26]
The add-on installs a script to close all open windows.

This script is placed in the add-on scripts category and under the description "Close all opened windows".

It is started with the command "KEY_CLOSE_ALL_WINDOWS" from the command interpreter. No control gesture is assigned to it by default.


++ List of running add-on ++[hdr27]
The add-on manager displays the list of installed add-on and their status: activated or deactivated.

But even though it is enabled, an add-on may not be loaded by NVDA. Usually the NVDA log reports this, but nothing in the Extensions Manager.

It can be interesting at some point to know which add-on are actually running.

To do this, the add-on installs a script under the description "Display running add-ons list" in the category of add-on in the "input gestures" dialog.

This script is started with the "KEY_RUNNING_ADDONS" command of the command interpreter. No control gesture is assigned to it.

add-on are listed by type:
- global add-on type: it is an add-on which provides additional accessibility whatever the application under focus.
- application add-on type: this is an add-on that provides additional accessibility for a specific application.
- speech synthesis driver add-on type:it is an add-on which installs a driver for a speech synthesis.
- Braille display driver add-on type: this is an add-on that installs a driver for a braille display.
- mixed add-on type: it is an add-on which mixes the various previous add-on types.


++ Development tools ++[hdr22]
This feature is not installed by default.

It installs the script whose description is "Display tools for add-on development dialog".

This script is stored in the "Tools" category of the NVDA "input gestures" dialog.

This script is started using the "KEY_TOOLSFORADDON" command of the interpreter. No control gesture is assigned to it.

Activating this script brings up a dialog presenting:
- the list of installed add-ons,
- a button to update, for the selected add-on, the version defined in the buildVars.py file,
- a button to update the "manifest.ini" file of the selected add-on with information from its "buildVars.py" file,
- a button to create, for the selected add-on, the catalog file (.pot),
- a button to prepare the selected add-on (performs several actions at once),
- the list of languages supported by the selected add-on,
- a button to create, for the selected add-on, the localization "manifest.ini" file for one or all the languages it supports,
- a button to create, for the selected add-on, its documentation files in HTML,
- a button to create, for the selected add-on, the "buildVars.py" file from the information in its manifest.ini file,
- a button to open the folder of the selected add-on in the explorer.


+++ Notions +++
To package an add-on (create the add-on installation file), we recommend that you use the "nvda adon scons template".
This model uses a "buildVars.py" file which defines, for an add-on, all the necessary information such as: its internal name, its version, its name and its description to be translated into each language supported by it.
This model is also used to allow the translation of add-on strings with the translation system set up by the "NVDA-addon.org" community.

The objective of this model is, when an add-on has been developed, by a simple command and after having informed the "buildVars.py" file of:
- create the manifest.ini file ",
- create all the localization "manifest.ini" files,
- compile all the .po files,
- create the html documentation files,
- finally create the add-on installation .nvda-addon file.


When we create an add-on, there is nothing. You must create the "manifest.ini" file yourself, possibly the localization "manifest.ini" file and the documentation file.The objective of these tools is placed in this condition and is:
- on the one hand, to get closer to the "adon scons template" so that it is easy enough to package the add-on that we have finished developing,
- on the other hand, to test all or part before using the model to create the add-on.


+++ Creation of the buildVars.py file +++[hdr22-1]
The first step is to create the "buildVars.py" file from the information in the "manifest.ini" file that we created for the development of the add-on.

The "Create the buildVars.py file" button starts this operation.

It is only this file that we will then modify to update the "manifest.ini" file (change of version or description for example).

To be used with the "adon scons template", it will have to be completed by filling in the information which is not found in the "manifest.ini" file.

+++ Updating version of the add-on +++[hdr22-2]
The "Update add-on version" button allows you to modify the version defined in the buildVars.py file of the selected add-on.

It presents a dialog box containing an edit zone initialized with the current version of the file.

Pressing the "OK" button saves the new version in the file.

+++ Updating manifest.ini +++[hdr22-3]
The "manifest.ini" file must be updated as soon as the "buildVars.py" file is modified.

Use the "Update manifest.ini file" button for this.

+++ Creation of localization "manifest.ini" file +++[hdr22-4]
Any modification of the "addon_summary" or "addon_description" information of the "buildVars.py" file requires the translation of this description into each language supported by the extension (taken into account in the nvda.po file and compilation of this file) .

In order for the add-ons' Manager to present this information to the user for the language chosen for NVDA, you must create or update the localization "manifest.ini" file for that language.

The button "Create the localization manifest.ini file" allows this. It is possible to update the file for the selected language or for all languages.

+++ Create HTML documentation +++[hdr22-5]
Add-oon documentation files can be either in "markdown" (. Md) or "txt2tags" (.t2t) format.

To be presented to the user in a browser, these files must be converted to HTML.

This is possible simply using the "Create HTML documentation files" button after selecting the add-on in the list of add-ons and choosing a language or all the languages in the list of languages.

Opened in the browser, these HTML files need style files (style.css for Markdown files and style_t2t.css for txt2tags files) placed in the add-on's "doc" folder.

+++ Creation of the catalog file +++[hdr22-6]
The "Create POT file" button is used to create the catalog file for the selected add-on.

Once created, this file is placed in the add-on's "locale\en" folder and is named "version-name.pot" where "name" is the name of the extension and "version" is its version.

+++ Preparation of the add-on +++[hdr22-7]
The "Prepare add-on" button launches, for the selected add-on, the execution of the following actions:
- update of its "manifest.ini" file from the "buildVars.py" file,
- creation of the localization "manifest.ini" file for each supported language,
- creation of HTML documentation files,
- creation of the catalog file.


+++ Exploration of the add-on +++[hdr22-8]
The "Explore add-on folder" button opens Windows Explorer in the selected add-on folder.


++ User configuration management ++[hdr30]
+++ Presentation +++
The purpose of this feature is to allow the user to restart NVDA with the user configuration of his choice.

For this, it relies on the possibility that NVDA offers the user to indicate the path of the configuration directory in the command line that starts NVDA.

All the configuration parameters are saved in a specific folder on the hard drive and by default this folder is located:
- for an installed NVDA, in the "c: \ Users \ UserName \ AppData \ Roaming" folder and is named "nvda".
- for a portable copy: in the program folder of this copy and is called "userConfig".


But this configuration folder can have another name and be located elsewhere on the hard drive or USB drive.

To ask NVDA to use it, just indicate it by launching NVDA with the command line:
nvda.exe -c "directoryPath"

If the directory does not exist, NVDA creates it when it starts up and initializes it as when it was first started after installation.

Otherwise, NVDA starts using the settings in this configuration folder.

It is therefore possible to have several user configurations with the same NVDA.

This allows for example to have, in addition to the basic configuration, either a test configuration to try new extensions, or a configuration with a very precise setting for a particular situation.

This functionality therefore provides the means to:
- define the user configurations that will be used,
- initialize new configurations by importing parameters from another configuration,
- start NVDA with the configuration of your choice without needing to use the command line.


+++ Manage user configuration folders +++[hdr30-1]
First of all, you must define the configurations that will be used.

For this, the extension installs the script "Display the dialog to manage user configurations" which is launched using the interpreter command "KEY_USER_CONFIG_MANAGEMENT".

No input gestures is assigned to it, but it is still possible to do so using the NVDA "Input gestures" dialog.

This command is used to display the "User configuration management" dialog which presents:
- the list of usable configuration folders,
- the "Restart NVDA with this configuration folder" button,
- the "Modify or prepare this file" button,
- the "Add a new folder" button,
- the "Add an existing folder" button,
- the "Delete this folder" button,
- the "Empty this folder" button,
- the "Explore this folder" button,
- the "Close" button to close the dialog.


The list contains all the folders added by the user and this added automatically by the extension.

The active configuration folder is signaled by voice and by the "checked" symbol in front of its name.

When this dialog is displayed for the first time, the extension automatically places it in the list and saves it.

For this folder, the "Delete this folder" and "Empty this folder" buttons are not present.

A newly added folder that is not yet a configuration folder is marked with a question mark.

An NVDA configuration folder is characterized by its content. It must contain, in particular, the following elements:
- the "addons" folder,
- the "profiles" folder,
- the "updates" folder,
- the "nvda.ini" file.


The "modify this folder" button is not present if the selected folder is the active configuration folder.


++++ Adding a folder ++++[hdr30-1-1]
The "Add a new folder" and "Add an existing folder" buttons allow you to add a folder to the list of configuration folders.

Pressing the first button displays the "Add a new folder" dialog which shows:
- an edit zone to enter the folder identifier,
-an edit zone to enter the path of the folder location,
- the "Browse ..." button to find the location of the folder,
- the "Add" button to validate and add the folder in the list,
- the "Cancel" button.


The folder identifier is used to name the folder like this: "nvdaUserConfig-identifier".

It is under this name that the folder appears in the list and on the hard or USB drive.

Pressing the second button brings up the "Add an existing folder" dialog which presents:
- an edit zone to enter the full path of the existing folder,
- the "Browse ..." button to find this folder,
- the "Add" button to validate the entry,
- the "Cancel" button.


++++ Deletion of folder ++++[hdr30-1-2]
The "Delete this folder" button allows you to remove the selected folder from the list and erase it from the drive.

This button is not available if the folder is the folder of the active configuration.

Confirmation of deletion for this action will be requested.

++++ Preparation or modification of the folder ++++[hdr30-1-3]
Depending on whether the folder is a configuration folder or not, the dialog shows respectively:
- either the "Modify the folder" button,
- or "Prepare the folder" button.


They aim to provide the tools to import settings from another configuration folder.

Activating these buttons each displays its own dialog which is differentiated only by their title.

In these dialogues we find:
- the list of folders from which the import will be done (only the configuration folders are presented),
- the "Import add-ons" button,
- the "Import speech dictionaries" button,
- the "Import symbol or punctuation pronunciations" button,
- the "Import input gestures changes" button,
- the "Import configuration profiles" button,
- the "Import NVDA parameters (normal configuration)" button,
- the "Import all the configuration" button,
- the "Close" button to end the dialogue.


The name of the folder that will be modified is indicated in the title of the dialogs.

The action of each button concerns the content of the folder selected in the list.

For the import of add-ons, it is possible to import all or part of the add-ons of the selected folder and to keep or not the add-ons already included in the folder to modify. The same goes for importing profiles.

Importing the entire configuration allows you to completely duplicate the selected folder and thus have an identical copy of the configuration of this folder.

++++ Restarting NVDA with another configuration ++++[hdr30-1-4]
The "Restart NVDA with this folder" button allows you to restart NVDA with the configuration of the selected folder.

This folder can be:
- either a complete configuration folder: NVDA will restart with the settings from this folder.
- or an incomplete folder (marked with a question mark): NVDA will restart by initializing this folder and using the parameters which have been included in it by importation.


In order for this other configuration to benefit from the same possibility of restarting, this add-on must also be installed there.

In this case, it will not be necessary to redo the addition of the configuration folder. The add-on will resume previously saved folders.

This registration is done in the "NVDAExtensionGlobalPlugin-userConfigs.ini" file stored in:
- the NVDA program folder if it is a portable copy,
- the user's "AppData \ Roaming" folder if it is an installed NVDA.


++++ Exploration of the configuration file ++++[hdr30-1-5]
The "Explore this folder" button opens the configuration folder selected in the explorer.

+++ Examples of use +++
++++ Starting NVDA with a new blank configuration ++++
- type "NVDA + j" followed by "n" to display the dialog.
- press the "Add a new folder" button.
- enter the identifier of the configuration file (for example myTestConfig"),
- choose the location of the configuration folder: by default it is the NVDA program folder, but it can be elsewhere on the hard disk and even on a USB drive.
- press the "Add" button: the folder appears in the list with a question mark and is selected.
- click on "Restart NVDA with this folder".


NVDA reboots and initializes the configuration as during a post install boot.

++++ Start NVDA with identical configuration ++++
After the first 5 steps:
- press the "Prepare the folder" button to display the dialog.
- press the "Import all configuration" button and wait because this takes some time.
- press the button "Restart NVDA with this folder".


++++ Start NVDA with an existing configuration ++++
- type "NVDA + j" followed by "n" to display the dialog.
- press the "Add an existing folder" button.
- choose the path of the configuration folder: it can even be on a USB drive.
- press the "Add" button: the folder appears in the list and is selected.
- click on "Restart NVDA with this folder".


By combining the previous example and this one and using a USB drive as a medium, you can find the same configuration on different machines.

++ Text analysis ++[hdr31]
This functionality is currently being tested.

When editing or proofreading a document using only speech, inconsistencies such as unmatched parentheses, unintended formatting changes, extra spaces, and spurious or unspaced punctuation marks can often be missed.

The "Text analysis" feature installs a tool (analyzer) which warns you of these irregularities, using a voice message or a WAV file when replaying by word or by line.

You can configure the analyzer to announce these irregularities by number, description, or sound.

The analysis is broken down into three research groups:
- search for mismatches between symbols,
- search for anomalies: multiple contiguous spaces, space or tabulation at the end of the line, isolated or badly spaced punctuations, missing or misplaced capitals, missing or unexpected spaces before or after a punctuation.
- search for formatting changes: font name, color, size, attributes, style.


It is possible to deactivate a search group as well as, individually, each action of a group.

To do this, the "Text analysis" category is added in the extension settings dialog.

The settings in this category are specific to the active profile that is announced when the category is selected.


+++ Activation / deactivation of the analyzer +++[hdr31-1]
The analyzer can be turned on or off in three ways:
- using the "KEY_TEXT_ANALYZER" command of the interpreter,
- using the "Activate text analyzer" checkbox located in the "Text analysis" category of the extension settings dialog,
- using the script "Activate or deactivate the text analyzer": no input gesture is assigned to it, but it is possible to do so using the NVDA "input gestures" dialog.


Enabling and disabling the analyzer only affects the active configuration profile.

The checkbox "Activate the text analyzer when starting the extension" in the "Text analysis" category fixes, for each profile, the activation state of the text analyzer when the extension is launched. 'extension.

The analiser activated, it is analyzed each time the cursor is moved from word to word, or from line to line in the text edit zones.

The result of the analysis is indicated according to the choice made, by:
- an audible beep: the frequency and length of the beep can be configured.
- a voice message: by default, it is "Alert", but this can be modified.
- a sound chosen from a list.
- a voice message giving the number of irregularities found.
- a voice message giving a detailed description of the irregularities found.


For the alert configuration, see the "Alert" group of the "Text analysis" category.

+++ Analyze configuration +++[hdr31-2]
++++ Checking for symbol mismatches ++++[hdr31-2-1]
It is enabled by default.

Some symbols like parentheses, brackets, braces usually go in pairs: an opening symbol, a closing symbol.

This research consists of verifying this concordance.

The possible symbols are listed in the "symbols" list of the "Symbol concordand" group of the "Text analysis" category.

Each symbol may or may not be part of the search depending on whether it is checked or unchecked in the list.

The symbols in the list depend on the language chosen for NVDA. They are defined in the "textAnalyzer.ini" file placed in the folder associated with the language of the "locale" folder.


++++ Finding anomalies ++++[hdr31-2-2]
It is enabled by default.

The list of anomalies to be sought is presented in the "Anomalies" group of the "Text analysis" category.

These are :
- The multiple contiguous spaces,
- Space or tab at the end,
- Isolated or unspaced punctuation,
- Missing or inverted capitals,
- The obligatory space before the symbol,
- The obligatory space after the symbol,
- The unexpected space before the symbol,
- The unexpected space after the symbol,


In the list, these are checked boxes. By default, they are all checked. By unchecking a box, the verification concerning it will not be done.

For anomalies concerning spaces around a symbol, the symbols involved are indicated by checked in the list containing all the symbols provided. Depending on the need, it is possible to check or uncheck a particular symbol. The symbols checked by default are defined for each NVDA language requiring it in the "textAnalysis.ini" file placed in the language folder of the "locale" folder.

++++ Search for formatting change ++++[hdr31-2-3]
It is disabled by default.
Formatting changes can be signaled by the analyzer depending on the status of the "Report changes" checkbox in the "Formatting" group of the "Text Analysis" category.

The formatting changes concern:
- the font name,
- the font size,
- the font attributes,
- the colour,
- the style.


They can be included or excluded individually from the search by checking or unchecking them in the "Types" list of the same group.

+++ On-demand scan +++[hdr31-3]
The extension installs scripts to analyze text at the cursor position on demand.
These scripts are:
- "Analyze the word under the cursor": "MAIN_KEY_WORD_TEXT_ANALYZER", command of the "KEY_WORD_TEXT_ANALYZER" interpreter,
- "Analyze the line under the cursor": "MAIN_KEY_LINE_TEXT_ANALYZER", interpreter command "KEY_LINE_TEXT_ANALYZER",
- "Analyze the sentence under the cursor": "MAIN_KEY_SENTENCE_TEXT_ANALYZER", interpreter command "KEY_SENTENCE_TEXT_ANALYZER".
- "Analyze the paragraph under the cursor": "MAIN_KEY_PARAGRAPH_TEXT_ANALYZER", interpreter command "KEY_PARAGRAPH_TEXT_ANALYZER".


+++ Move cursor to next/previous irregularity +++[hdr31-4]
The following scripts allow to move the cursor to the next/previous irregularity:
- move the cursor to the next irregularity: interpreter command "KEY_MOVETONEXTALERT_ANALYZER",
- move the cursor to the previous irregularity: interpreter command "KEY_MOVETOPREVIOUSALERT_ANALYZER",


The search for the irregularity is carried out in a range of 100 lines. If no irregularity is found in this range, a request is made to the user to continue the search in a new range.


These two scripts have no input gesture associated with them, but it is possible to do so using the "Input gestures" dialog. They are placed in the "ADDON_SUMMARY" category.

++ Announcement of cursor position in edit boxes ++[hdr32]
The script "Toggle reporting of current caret position in edit box" allows you to have the cursor position announced or not when it is in an edit zone.

This position is relative to the start of the line on which the cursor is located.

The activation or deactivation of this announcement is specific to the current profile.

The script is installed without a input gesture and with the "KEY_POSITION_REPORT" interpreter command.

If desired, NVDA's "input gesture" dialog allows you to assign an input gesture to it.

++ Temporary audio output device ++[hdr33]
This feature is installed by default.

It allows you to temporarily change the current audio output device to another audio output device without impacting NVDA's configuration for all configuration profiles.

Each configuration profile will retain the settings configured in the "Speech" category used by NVDA, including its audio output device.

We will name this device, "Temporary Audio Device".

When a temporary audio device is active, audio sound (voice messages and tones) emitted by NVDA will be sent to that device regardless of the audio output device in the active configuration profile.

Sounds emitted by the system continue to be sent to the audio output device selected in the Windows settings.

Since nothing is changed in NVDA's configuration, automatic or manual registration of NVDA does not keep any trace of this device.

To return to normal operation, ie the use of the audio output devices of the configuration profiles, it will suffice to abandon the temporary audio device.

To achieve all this, the extension installs several scripts.

+++ Temporary audio device manager +++[hdr33-1]
This script has the description "Display the temporary audio device manager" and is placed in the "Speech" category of NVDA's "Input gestures" dialog.

No input gesture is assigned to it, but it is still possible to assign it one using this dialog.

It is started using the "KEY_TEMPORARY_AUDIO_DEVICE_MANAGER" command of the command interpreter.

In response to this command, the "Temporary audio device manager" dialog is displayed which presents:
- the "Current temporary audio device" text box: this indicates the active temporary audio device.
- the drop-down list which lists the audio output devices of the system.
- the "Set as temporary audio device" button,
- the button "Abandon the temporary audio device",
- the "Close" button.


In the list, movement is done using the "up" and "down" arrows.

When a peripheral is selected, a double beep is heard at its exit to make it possible to check its correct operation or connection and thus not to activate it.

Switching to the selected device is done either by pressing the "Set as temporary audio device" button (default button), or if the focus is in the list, with the "Enter" key.

This device becomes the temporary audio device.

Audio from NVDA is then routed to the output of that device.

In order not to end up with a device that emits no sound,the extension asks the user if they confirm the use of this device.
This request is made after failover to this device and is timed out.

It can be prevented using the "Ask for confirmation" option in the "Temporary audio device" group of the "computer" category of the "Global settings" dialog of the extension.

This confirmation request consists of displaying a dialog box for a limited time and asking the user to accept the use of the new audio output device.

The display time of this dialog box can also be configured using the "Maximum waiting time for confirmation" drop-down list located in the same group as the previous option.

Pressing the "OK" button or the "Enter" key validates the acceptance.

At the end of the delay without pressing the "OK" button or the "Enter" key, the box closes and the sound returns to the previous audio output device.

To return to normal operation, ie without a temporary audio device, all you have to do is restart the script and activate the "Leave up temporary audio device" button or, more abruptly, restart NVDA.

In the list of audio output devices, it is possible to check certain devices. These devices will be used for the script "Define, as temporary audio device, the following device in the list of checked devices of the manager of the temporary audio device" (see below).

+++ Temporary audio device change +++[hdr33-2]
There are two ways to change the device:
- either by launching the previous script and choosing another device,
- or by using the script (see below) which allows to loop between the checked devices of the "devices" list of the temporary audio device manager.


This script has the description "Set, as temporary audio device, the next device in the list of checked devices of the temporary audio device manager " and is placed in the "Speech" category of the "input gestures" dialog.

No input gesture is assigned to it. But it is still possible to do this using the previous dialogue.

It is started using the "KEY_SET_TEMPORARY_AUDIO_DEVICE" command from the command interpreter.

Each time the script is started, a new audio output device is set as a temporary audio device.

This device is chosen from the devices that were previously checked in the list of audio output devices in the "Temporary audio device manager" dialog (see above). The one selected is the one following in the list, the current audio output device.

After changing the device,a timed confirmation request (optional) is requested (see chapter "Temporary audio device manager").

+++ Leave up the Temporary audio device +++[hdr33-3]
This script has the description "Leave up Temporary Audio Device" and is placed in the "Speech" category of the "Input gestures" dialog.

No input gesture is assigned to it. But it is still possible to do this using the previous dialogue.

It is started using the command "KEY_LEAVEUP_TEMPORARY_AUDIO_DEVICE" from the command interpreter.

The script has no effect if no temporary audio device is active.

Otherwise, NVDA's audio output is then routed to the audio output device of the active configuration profile.

+++ Set or leave up temporary audio device +++[hdr33-4]
This script has the description "Set, as temporary audio device, the next device in the list of checked devices of the temporary audio device manager" and is placed in the "Speech" category of the "Input gestures" dialog.

No input gesture is assigned to it. But it is still possible to do this using the previous dialogue.

No interpreter command is assigned to it either.


This script combines the two previous scripts under one script.

The first press of the input gesture launches the script "Set, as temporary audio device, the next device in the list of checked devices of the temporary audio device manager".

The second press in a short time, launches the script "Leave up the temporary audio device".

++ NVDA audio output orientation ++[hdr34]
This feature makes it possible to separate the sound from NVDA from the sound emitted by the other audio sources and thus to hear in one ear, the sound from NVDA and in the other ear, the sound from the other audio sources.

Only applications with a two-channel audio source and using the same audio output device are affected.
It also allows you to adjust the volume level of tonalities played by NVDA (when Sasapi is not used) and change the gain of sound files from NVDA and the add-on.

It is installed by default.

For audio direction, technically this means zeroing out the volume level of NVDA's right or left audio channels and audio sources.

NVDA being a monophonic application, the same sound is played on both channels. There is no phonic audio loss in zeroing a channel.

But this is not the case for stereophonic applications.

To direct NVDA's sound, the extension installs the following scripts:
- Hear NVDA on the right and the sound of the audio source of the application under the cursor on the left (command: KEY_SPLIT_RIGHT_FOCUS),
- Hear NVDA on the right and the sound of all audio sources on the left (command: KEY_SPLIT_RIGHT_ALL),
- Hear NVDA on the left and the sound of the audio source of the application under the cursor on the right (command: KEY_SPLIT_LEFT_FOCUS),
- Hear NVDA on the left and sound from all audio sources on the right (command: KEY_SPLIT_LEFT_ALL),
- Hear NVDA and the sound of the audio source of the application under the cursor in the center (command: KEY_SPLIT_CENTER_FOCUS),
- Hear NVDA and sound from all audio sources in center (command: KEY_SPLIT_CENTER_ALL)
- Hear the sound from the audio source of the application under the cursor in the center (command: KEY_CENTER_FOCUSED_APP)
- Display the Audio Source Manager (command: KEY_SOUND_SPLIT_MANAGER)


No input gestures are assigned to them. But it is still possible to do this using NVDA's "Input Gestures" dialog. These scripts can be found under the "Sound Control" category of this dialog.

The "KEY_CENTER_FOCUSED_APP" command is operational even if the feature is not installed in order, possibly, to be able to rebalance the audio of certain applications that remained unbalanced after uninstalling the feature.

+++ Audio source manager +++[hdr34-1]
The "Audio Source Manager" dialog allows, besides NVDA sound orientation, to:
- set the volume level of both NVDA audio channels and audio sources,
- adjust the volume of NVDA tones when Wasapi is not used,
- change the gain of NVDA sound files.

He introduces :
- the list of audio sources,
- the potentiometer to modify the volume of the selected source,- except for the "NVDA" source, the box checked to modify the "mute" state of the selected source,
- the potentiometers to modify the levels of the left and right channels of the selected source,	
- for the "NVDA" source only and without Wasapi, the potentiometer to adjust the volume of the tones emitted by NVDA and the button to modify the gain of the sound files
- for only the "NVDA" source, the button to modify the gain of the sound files.


When the list is focused, the following commands are allowed:
- hear the audio source selected on the right: "right arrow",
- hear the audio source selected on the left: "left arrow",
- hear the audio source selected in the center: "space",
- Hear NVDA on the right and the selected audio source on the left: "shift + right arrow",
- Hear NVDA on the left and the selected audio source on the right: "shift + left arrow",
- Hear NVDA and the audio source selected in the center: "capital letter + space",
- Hear NVDA on the right and all audio sources on the left: "control + right arrow",
- Hear NVDA on the left and all audio sources on the right: "control + left arrow",
- Hear NVDA and all audio sources in the center: "control + space",
- increase or decrease the volume of the selected audio source by one step: "control + up or down arrow",
- increase or decrease by a double step, the volume of the selected audio source: "control + previous or next page",
- maximize or minimize the volume of the audio source: "control + start or end",
- mute or restore the sound of the audio source: "control + m",
- increase or decrease the main volume by one step: "control + shift + up or down arrow",
- increase or decrease by a double step, the main volume: "control + uppercase + previous or next page",
- maximize or minimize the main volume: "control + shift + start or end".


This list is automatically refreshed when the cursor is given to it.

Channel toggle changes or volume level changes are applied immediately after each command. However, to find them after restarting NVDA, the NVDA configuration must be saved.

By default, the audio source volume level cannot be set higher than the main volume level. But the option "Raise master volume if necessary" can disable this limitation. This option can be found in the "Volume change" group of the "Computer" category of the extension's "Settings" dialog.

By default and when wasapi is not used, NVDA's tone level is set to 50 which is NVDA's internally set base value.

A protection is provided to avoid putting, simultaneously,to zero the level of NVDA's audio channels and that its volume level is lower than its configured undo threshold.

When an audio source is selected, the channel balance status is announced as well as the mute status.

When restarting NVDA or if the add-on is disabled or uninstalled, NVDA is again heard on both audio channels, while the audio sources remain in their state (remembered by Windows).

Warning: NVDA and the audio sources must use the same audio output device, such as the sound mapper, for proper operation. Besides, the functionality is of interest only in this case.

When the list of audio output devices is focused, selecting a device triggers a tone to play on that device. It is possible to prevent this emission by unchecking the "Play tone on   audio output device" option of the "Audio source manager" group of the "Advanced" category of the global settings of the add-on.

In this list, the following commands are available:
- increase or decrease the main volume by one step: "control + shift + up or down arrow",
- increase or decrease by a double step, the main volume: "control + shift + previous or next page",
- maximize or minimize the main volume: "control + shift + start or end".


++++ Changed gain of NVDA and add-on sound files ++++[hdr34-2]
When the NVDA source is selected, the "Change Sound Files Gain"button is then activated.
Pressing this button opens the "NVDA Sound Files's gain modification" dialog which shows:
- the list of sounds used by NVDA and the add-on,
- the "Play" button which allows you to listen to the selected sound,
- the gain choice list: a positive value amplifies the sound, a negative value reduces it.
- the "Test" button which allows you to listen to the result of the sound modification with the selected gain,
- the "Apply gain" button to apply the gain to the selected sound,
- the "Apply gain to all sounds" button to apply the gain to all sounds,
- the "Reset sound" button to restore the selected sound to the way it was when NVDA was installed,
- the "Reset all sounds" button to reset all sounds to the way they were when NVDA was installed.


NVDA sounds are presented in the list with a translatable description.

The sounds of the add-on are presented by a prefix, a "_" and the name of the sound file.
The prefix designates the origin of the sound file: NVDAExtensionGlobalPluginSounds or NVDAExtensionGlobalPluginSoundsTextAnalyzerAlerts.

If the gain is zero, the "Test", "Apply gain" and "Apply gain to all sounds" buttons are not present.

Pressing the "Apply gain" button modifies the original sound and saves the result in another sound file. This sound file will then be used. The "Reset sound" button allows you to return to the original sound by erasing this new file.

Modified sounds are marked in the list with the indication "modified". They are all stored in the "NVDAExtensionGlobalPlugin-NVDAWaves" folder created for the occasion in the user configuration folder. This folder does not exist if no sound is modified.

If the selected sound has not been modified, the "Reset sound" button is not presented.

If there are no already modified sounds in the list of sounds, the "Reset all sounds" button is not presented.

NVDA's startup sound cannot be changed because it is played before the add-on loads.It is possible to not authorize the modification of the gain of the sounds by unchecking the checkbox "Allow the modification of the gain" found in the "Advanced" category. This box is checked by default.

+++ Technical details +++
To achieve the functionality of adjusting the volume of NVDA tones when Wasapi is not used, the add-on has changed the operation of the "beep" function of the "tones" module of NVDA.

This can be a problem if another add-on has also modified it.

To avoid this kind of conflict, the add-on gives the possibility to not activate this feature by unchecking the "Allow tonalities's volume adjustment" option which is located in the "Advanced" category of the add-on' settings. . In this case, there will be no modification of the "beep" function by the extension.

If Wasapi is used, this option is not present because NVDA's tonalities and sounds adjustment is done by NVDA itself.

By default, This option is checked.

In order for the modified sound files to be played instead of the original sounds, the playWaveFile function of the nvwave.py module of NVDA has been replaced. This replacement feature is common with the "Temporary Audio Device" feature.

If modifying this function is a problem, you must both uncheck the "Allow gain modification" option and uninstall this feature.

++ Quick activation or deactivation of extensions ++[hdr35]
To enable or disable extensions, NVDA natively offers the Extension Manager.
However in some cases it may be necessary to deactivate some or all of the extensions leaving only a few extensions activated.
With the extension manager, it is then necessary to review each extension to activate or deactivate it.

This extension tries to make this manipulation faster and for that, it provides a script to display the "Quick add-ons activation" dialog.

This script is started using the "KEY_QUICK_ADDONS_ACTIVATION" command of the command interpreter. No input gesture is associated with it. But it is possible to do this using NVDA's "input Gestures" dialog.
It can be found in the "ADDON_SUMMARY" category with the description "Activate quick add-ons activation dialog".

This dialogue presents:
- the list of add-ons installed, activated or deactivated,
- the "Check all" button to check all the add-ons of the list,
- the "Uncheck all" button to uncheck all the add-ons of the list,
- the "Save and restart NVDA" button to validate the changes and restart NVDA,
- the "Cancel" button to close the dialog without any modification of the add-ons activation status.


The list shows only the add-ons enabled or disabled when the dialog is displayed. Incompatible add-ons, to be activated or deactivated at the next start-up, are not included in the list.

When the dialog is displayed, the activated add-ons are checked.

To change the activation status of an add-on, all you have to do is check it to activate it, or uncheck it to deactivate it.

The changes will only be taken into account when the "Save and restart NVDA" button is pressed.


+ Options +
++ Removed the announcement of the description of objects in Windows ribbons ++[hdr100]

In Windows ribbons, NVDA is too chatty unnecessarily.
By default, this add-on prevents the advertisement of the description which seems quite unnecessary.

But this can be disabled using the "No object description inWindows ribbons" option found in the "Computer" category of the "add-on settings" dialog.

A restart of NVDA will then be necessary for the option to be taken into account.

++ Automatic window maximization ++[hdr102]
This option automatically maximizes windows that are brought to the foreground.

By default, it is enabled.

You can deactivate it by unchecking the option "Automatically maximize windows " in the "Computer" category of the "Settings" dialog of the add-on.

++ Announcement of punctuation when moving by word ++[hdr103]
NVDA allows you to move word by word in documents using the "control + right arrow" and "control + left arrow" keyboard commands.

The symbols and punctuation marks are then said according to the level of punctuation and symbols configured for the current configuration profile.

This option allows you to configure the level of symbols and punctuation that will be used only when moving by word.

This choice is saved for the current configuration profile.It is configured in the "NVDA enhancement" category of the add-on's "Settings" dialog and named "Punctuation/symbol level on word movement".

It is only present if the "Announcement of the function associated with the" copy "," Paste "style editing commands is installed.

It is presented in the form of a combobox which allows you to choose:
- either the level of symbols and punctuation of the current configuration level (selected by default),
- or one of NVDA's symbol and punctuation levels (None, some one, most, all).


++ Reporting spelling errors by beep or voice announcement ++[hdr104]
When the "Spelling error" option in the "Document information" group of the "Document formatting" category of NVDA settings is checked, NVDA will sound a special sound for the spelling error that comes from be made.

This sound is emitted just after the hit on the space bar ending the word.

Some users find this sound unpleasant, the extension brings the possibility of replacing this sound either by a double beep, or by the voice announcement "Spelling error".

The choice is made in the group "Reporting spelling errors" of the category "NVDA enhancements" of the global settings of the add-on.

++ Blocking "Insert" and "Capslock" keys ++[hdr105]
(available for NVDA versions lower than 2023.1 if the "Selective announcement of command keys" feature is installed)

It can be useful in some cases to prevent the action of the "Insert" and "Caps lock" keys.

Their initial role is:
- The "Insert" key can switch from "Insert" mode to "Overtype" mode and vice versa.
- The "Caps lock" key simulates the permanent depression of the "Shift" key.


NVDA allows the user to define these keys as "NVDA" key. But in this case, the "Insert" key like the "Caps Lock" key only plays their initial role if there is a quick double press.
 
By configuration, the add-on gives the possibility that these keys have no action when they are in their initial role.

This configuration is done by configuration profile using one check box per key (See the "Key lock" group in the "Keyboard" category of the current profile).

When the key action is blocked, a beep sounds.


++ Pronunciation of non-alphanumeric characters when per-character keyboard echo is disabled ++[hdr106]
This option allows non-alphanumeric characters to be spoken when keyboard echo by characters is disabled.

This allows some users to hear, for example, typed punctuation symbols, even if they have disabled keyboard echo by character.

It is configured using the "Speak non-alphanumeric characters anyway when keyboard echo by character is disabled" checkbox found in the "Keyboard" category for the current configuration profile.

By default, it is unchecked.

+ Advanced options +
++ Signaling by sound of an error in the NVDA log ++[hdr300]
Experienced users may have noticed that when using a development version of NVDA (snapshot master or next version), any error entered in the NVDA log is signaled with a sound. But with final versions or candidate releases, this signal is not emitted.

This option offers the choice between:
- broadcast the sound signal whatever the version of NVDA,
- never to broadcast the signal,
- to broadcast the signal only until the next start of NVDA,
- broadcast the signal only for development versions.


To make this choice, all you have to do is select the option in the combobox list named "Play sound on logged errors" in the "Advanced" category of the "Settings" dialog of the add-on.
By default, the option "Only for development versions" is selected.

++ Titling of dialog boxes with the name of the add-on ++[hdr302]
This option allows you to title or not the dialog boxes of this add-on with its name.
It can be found in the "Advanced" category of the "Settings" dialog.

By default, this option is checked and the title of the boxes is in the form: "ADDON_SUMMARY - NVDA - dialog title".


++ Configuration of the delay for waiting for repetition of the same input gesture ++[hdr303]
Some scripts in this add-on perform different actions depending on the number of times the input gesture associated with the script is dialed.
The repetition of the control gesture must be done within a short time (500 ms by default).

For a script performing three different actions, the mechanism is:
- At the first press, the time delay is started,
- if there is no second press before the end of the time delay, the first action is carried out. Otherwise the time delay is restarted on this second press.
- if there is no third press before the end of the time delay, the second action is carried out. Otherwise, the timer is stopped and the third action is performed.


Depending on the user's dexterity or the hardware configuration, this timeout may be too long or too short.

The option entitled "Delay between repeat of same gesture" in the "Advanced" category of the "Settings" dialog of the add-on allows you to adjust this timeout as needed.

++ Standard use of the numeric keypad ++[hdr304]
By default, NVDA uses certain keys on the numeric keypad, such as the arrow keys, the "multiply", "divide" keys, and the "plus" key, to activate scripts.

The objective is to restore to each key of the numeric keypad, temporarily or permanently, its normal functioning, composed alone or with a modification key such as "control", "Alt", "capital" (The "NVDA" key is excluded).

These keys are:
- the "right and left arrow" keys,
- the "up and down arrows" keys,
- the "previous and next page" keys,
- the "start and end" keys,
- the "multiply" and "divide" keys,
- the "More" button.


To enable or disable the use of the numeric keypad in standard operation and if the option "allow the standard use of the numeric keypad" in the "Numeric keypad" grouping of the "Keyboard" category is checked, the add-on offers:
- a script whose description is "Enable or disable the standard use of numeric keypad". No input gesture is assigned to it by default.
- the "KEY_TOGGLE_NUMPAD_NAVIGATION" command from the command interpreter.
- activation by two successive presses on the "Num lock" key if the option "Enable / disable numeric keypad's standard use with num lock key" ("Numeric Keypad" grouping, "Keyboard" category) is checked.


The "Enable the standard use of the numeric keypad at NVDA's start" option ("Numeric keypad" grouping, " Keyboard " category), allows, if it is checked, to use the numeric keypad as standard from the start of NVDA , but the option that allows standard use of the numeric keypad must also be checked.

++ Num lock management ++[hdr305]
This feature is partly taken from the "sharedComputer" add-on (authors "Robert Hnggi <aarjay.robert@gmail.com>, Noelia Ruiz Martnez <nrm1977@gmail.com>" which seems not to have been updated since 2018 .

It consists of:
+++ reporting enabled numeric lock state when starting NVDA +++
By default and in "Desktop" keyboard layout, the add-on reports that Numeric Lock is enabled when starting NVDA.

But this can be disabled, as is the default for the "laptop" keyboard layout, using the "Report enabled state when NVDA starts" option in the "Numeric Lock" group of the "Keyboard" category of the add-on settings.


+++ Automatic activation/deactivation when activating a configuration profile +++
Each time a configuration profile is activated, it is possible to automatically enable or disable the numeric lock.

The choice is made in the settings of the configuration profile, in the "Keyboard" category of the "Numeric lock" group and with the list of choices "On activating the profile: ".

This list offers the following choices:
- "Do Nothing": the locking status is not modified.
- "Desactivate": the lock is desactivated.
- "Activate": locking is activated.


By default, the choice is:
- "Desactivate" for a "Desktop Computer" keyboard layout.
- "Do nothing" for a "laptop" keyboard layout.



++ Caps lock ++[hdr306]
By default, when NVDA starts, the enabled capital lock status is reported.

This reporting can be disabled by unchecking the "Report enabled state on NVDA startup" option in the "Capital lock" group of the "Keyboard" category of the add-on's global settings.

++ Key repeat limitation ++[hdr307]
When a key is pressed and not released quickly enough, Windows generates a series of keypresses which can be annoying especially in an editing area.

This feature attempts to keep this number of key presses to a minimum.

It is controlled by the "Limit repetitions" checkbox which is in the "Keystroke repetition" group of the "Advanced" category of the global parameters of the add-on and by the repetition delay which is configured in the same group.

When this option is checked, any new press of the same key that occurs within a delay less than the configured repeat delay is ignored.

By default, this box is unchecked and the snooze delay is set to 100 milliseconds

It is not possible to keep only the first key press because the delay with the following key press is too great (around 500 milliseconds).

Modifier keys are not affected by this limitation.

+ Other improvements +
++ Exploring the user configuration folder or nvda program folder ++[hdr202]
This add-on adds in the "tools" menu of NVDA a sub-menu "Explore NVDA" which offers two choice items:
- "explore my configuration folder": to open your user configuration folder in Windows explorer.
- "Explore the program folder": to open the NVDA program folder in the explorer.


Two scripts, placed in the "ADDON_SUMMARY" category of the NVDA "input gestures" dialog, are provided to perform these same actions and with the following descriptions:
- "Explor my user configuration's folder",
- "Explore NVDA programs's folder".


By default, no input gesture is associated with them.

++ Presentation of text formatting in a dialog ++[hdr203]
Basically, a double press of the "NVDA + f" input gesture presents the formatting information in the form of an HTML document.

This script aims to complete them and display them instead in a dialog box so that they can be read using the arrows keys.

It is started using the "KEY_REPORT_FORMATTING" command of the interpreter.


The description of the script is: "Display formatting info for the current review cursor position within a document in dialog box".

It is stored under the "ADDON_SUMMARY" heading of the "NVDA input gestures" dialog.

No input gesture is assigned to it by default.

++ Announcement of the text of confirmation style dialog boxes ++[hdr204]
NVDA considers some dialog boxes, such as confirmation dialogs, that the text they contain is a description.

So if the "Announce object description" option in the "Object overview" category of the NVDA "Settings" dialog is not checked, the text is not announced by NVDA.

This add-on implements the "Do not take account of the option called Report object descriptions during the display of the dialog box style confirmation" option in the "Advanced" category of the "Settings" dialog of the add-on to force, if checked, the announcement of the text of these boxes in all cases. This option is checked by default.


++ Running scripts in the "Input gestures" dialog ++[hdr205]
The NVDA "Input gestures" dialog allows you to configure the input gestures (keyboard shortcuts, braille display buttons, etc.) for the scripts (called commands in the NVDA user manual) available at this time. For more information, see the "Input gestures" chapter of this manual.

The extension makes it possible to execute scripts in this dialog, even if no input gesture is configured.


It modifies this dialog by adding the "Execute the script" button when a script is selected in the tree view.

The script can be executed using one of the following three actions:
- either by pressing this button,
- either by dialing the shortcut associated with the button,
- or - by pressing the space bar when the cursor is on the tree element.


By repeating the action several times quickly, the script will be executed as many times.

++ Automatic selection of the category in the "Input gestures" dialog ++[hdr206]
It may happen that we need to open the "Input gestures" dialog to know the input gestures provided by the active extension for the application under focus.

Without extension, the first category is selected by default.

In order to save time, the extension brings the selection of the category associated with the active extension for the application under focus.

It does this by looking for the category among the categories that provide scripts belonging to the active extension. But the latter can set up scripts in any category.

This category will then be automatically selected and expanded.

++ Selection of the last setting used in the synthesizer settings ring ++[hdr207]
NVDA's "NVDA + control + right or left arrow" input gestures allow you to jump from one setting to another in the synthesizer's settings ring.

But after restarting NVDA, the last used setting is forgotten.

This improvement attempts to overcome this drawback.

To do this, the add-on saves, at each movement in the synthesizer settings ring, the last setting used for each synthesizer and for each configuration profile.

This setting will then be selected again when NVDA starts up for the synthesizer and for the "normal configuration" profile or when profiles switching.

Warning: like all NVDA parameters, it is necessary that the NVDA configuration is saved before restarting NVDA (either automatically or manually) in order to find them after the restart.

++ Enhancements for Windows Explorer ++[hdr208]
The add-on brings the following scripts When the cursor is in the folder tree:
+++ Announcement of folder or file path under cursor +++
This script allows, when the cursor is positioned on one of the elements of the folder n of the Windows explorer tree, to:
- on the first press: to announce the reduced access path in the form: reader identifier\...\name of folder n-3\name of folder n-2\name of folder n-1\name of folder n\file or folder name.
- on the second press: to announce the full access path.
- on the third press: to copy the full path to the clipboard.


No input gesture or interpreter command is assigned to it by default.

The description of the script is: "Announce the reduced path of the folder or file under the cursor of Windows Explorer. Two presses: announce the full path. Three presses: copy the full path to the clipboard".

It is stored under the "ADDON_SUMMARY" section of the "input Gestures" NVDA dialog.

It is possible to associate a input gesture to it using this dialog.

The number of folders to keep for the reduced path is configurable (see the "Windows Explorer" group of the "Computer" category of the add-on's global settings. By default, this number is 4).

+++ Announcement, going up the folder tree, of the names of the folders making up the path of the folder containing the element under the cursor +++
This script, like the one announcing the reduced path, allows you to locate the element under the cursor without having to hear all the names of the folders that make up the full path.

Unlike the other script, it is not limited by the configuration, ie the number of path folders to keep.

It announces the name of the folders making up the path in the opposite direction, ie going up the tree of folders. This announcement can be stopped at any time by pressing the "Control" key.

For example, if the selected item is in folder n, NVDA will announce in the following order:
- the name of folder n followed by (n),
- the name of folder n-1 followed by (n-1),
- the name of folder n-2 followed by (n-2)
- the name of folder n-3 followed by (n-3),
- and so on up to the reader's identifier followed by the last level in brackets.


The option "Report   folder name of  reversed path with level" makes it possible not to announce the level of the folders. It is in the "Windows Explorer" group of the "Computer" category.

No input gesture or interpreter command is assigned by default to this script.

The description of this script is: "Announce the path of the file or folder under the cursor of Windows Explorer going up the tree structure of folders".

It is stored under the "ADDON_SUMMARY" section of the "Input Gestures" NVDA dialog.

It is possible to associate a input gesture to it using this dialog.


++ Speak typed words enhancement ++[hdr209]
In the following cases, NVDA does not speak the typed word when the "Speak typed words" option is enabled:
- a space is inserted in the middle of a word.
- after correcting a word using the "backspace" key followed by a space.
- after typing a single punctuation symbol followed by a space.


This improvement was initiated by Leonard de Ruijter (leonardder) in 2018 (see [https://github.com/nvaccess/nvda/pull/8110]) and closed in 2019 without having been implemented in NVDA.

It is enabled by default, but it can be disabled to regain basic NVDA functionality by unchecking the "Enhance speak typed words" option located in the "Advanced" category of the add-on's global settings.


+ Summary of the commands provided by this extension +

++ input gestures installed systematically ++
| Desktop computer | Laptop | Touch | Description |
| KEY_SHELL | KEY_SHELL | None | Start the add-on command interpreter |
| MAIN_KEY_CLIC_LEFT_MOUSE_BUTTON_At_NAVIGATOR | MAIN_KEY_CLIC_LEFT_MOUSE_BUTTON_At_NAVIGATOR | none | make a single left click at the position of the navigator object. The second press makes a double click |
| MAIN_KEY_CLIC_RIGHT_MOUSE_BUTTON_At_NAVIGATOR | MAIN_KEY_CLIC_RIGHT_MOUSE_BUTTON_At_NAVIGATOR | none | right-click at the position of the navigator object. The second press makes a double click |

++ Interpreter commands ++
| Order | Description |
| KEY_APPLICATION_INFORMATIONS | Display informations about the focused application |
| KEY_OBJECTS_LIST | Display the list's visible items making up current foreground object |
| KEY_TEMPORARY_AUDIO_DEVICE_MANAGER | Show Temporary Audio Device Manager |
| KEY_SET_TEMPORARY_AUDIO_DEVICE | Set, as temporary audio device, the next device in the list of checked devices in the temporary audio device manager |
| KEY_LEAVEUP_TEMPORARY_AUDIO_DEVICE | Discard temporary audio device |
| KEY_COPY_DATETIME | Copy date and time to the clipboard |
| KEY_RUNNING_ADDONS | Display running add-ons list |
| KEY_REPORT_FORMATTING | Display formatting info for the current review cursor position within a document in dialog box |
| KEY_ADDON_SETTINGS | Display add-on settings dialog |
| KEY_PROFILE_SETTINGS | Show extension settings dialog for current configuration profile |
| KEY_RENAMING | Display keyboard key renaming dialog |
| KEY_SELECTIVE_ANNOUNCEMENT | Display command key selective announcement dialog |
| KEY_COMPLEX_SYMBOL | Allow you to copy or type complex symbol |
| KEY_LAST_USED_COMPLEX_SYMBOL | Display the list of last used symbols |
| KEY_TOGGLE_NUMPAD_NAVIGATION | Enable or disable the standard use of numeric keypad |
| KEY_TEXT_ANALYZER | Enable or disable text analyzer |
| KEY_WORD_TEXT_ANALYZER | Analyze word under system cursor |
| KEY_LINE_TEXT_ANALYZER | Analyze Line Under System Cursor |
| KEY_SENTENCE_TEXT_ANALYZER | Analyze sentence under system cursor |
| KEY_PARAGRAPH_TEXT_ANALYZER | Analyze paragraph under system cursor |
| KEY_POSITION_REPORT | Enable/disable the announcement of the current cursor position in an edit box |
| KEY_SOUND_SPLIT_MANAGER | Display NVDA and applications channels manager dialog |
| KEY_DISPLAY_SPEECH_HISTORY | display speech history records |
| KEY_WINDOWS_LIST | Display the running application windows's list with opportunity to put one of them on the foreground or destroy it |
| KEY_ICONS_List | Shows the list of buttons on the System Tray |
| KEY_MINUTE_TIMER | Display dialog to start the minute timer.If minute timer already started, display dialog to report duration |
| KEY_MODULE_GUIDE | Display add-on user's guide |
| KEY_HELP_SHELL | Display the commands of the commands interpreter |
| KEY_LOG_VIEW | Open a dialog to manage NVDA logs |
| KEY_CLOSE_ALL_WINDOWS | Close all opened windows |
| KEY_USER_CONFIG_MANAGEMENT | Show dialog to manage user configurations |
| KEY_SAY_CURRENT_FOLDERNAME | report the name of current selected folder in the open or Save dialog box |
| KEY_VOICE_PROFIL_SWITCHING | Toggle voice profile switch mode |
| KEY_QUICK_ADDONS_ACTIVATION | Activate quick add-ons activation dialog |
| KEY_SHUTDOWN | Display dialog to shut down, reboot or hibernate the computer |
| KEY_TOGGLE_MUTE | Toggle current focused application volume mute |
| KEY_VOLUME_ON | Set on main and NVDA volume |
| KEY_TOOLSFORADDON | Display tools for add-on development dialog |
| KEY_USER_INPUT_GESTURE | Displays the dialog to manage the input gestures configured by user |
| KEY_MANAGE_VOICE_PROFIL | Display dialog to manage voice profile selectors |
| KEY_ADDING_TO_CLIP | Add selected text to clipboard |
| KEY_CLEAR_CLIP | Clear clipboard |
| KEY_REPORT_SPEECH_SETTINGS | Report current speech settings |
| KEY_DISPLAY_SPEECH_SETTINGS | Display current speech settings |
| KEY_APP_VOLUME_UP | Increase the volume of the application under focus |
| KEY_NVDA_VOLUME_UP | Increase the NVDA volume |
| KEY_MAIN_VOLUME_UP | Increase master volume |
| KEY_APP_VOLUME_DOWN | Decrease the volume of the application under focus |
| KEY_NVDA_VOLUME_DOWN | Decrease the NVDA volume |
| KEY_MAIN_VOLUME_DOWN | Decrease the main volume |
| KEY_APP_VOLUME_MAX | Maximize the volume of the application under focus |
| KEY_NVDA_VOLUME_MAX | Maximize the NVDA volume |
| KEY_MAIN_VOLUME_MAX | Maximize the main volume |
| KEY_APP_VOLUME_MIN | Minimize the volume of the application under focus |
| KEY_NVDA_VOLUME_MIN | Minimize the NVDA volume |
| KEY_MAIN_VOLUME_MIN | Minimize the main volume |
| KEY_APP_VOLUME_PREVIOUS_LEVEL | Set the volume of the application under focus to the previous level |
| KEY_NVDA_VOLUME_PREVIOUS_LEVEL | Set the NVDA volume to the previous level |
| KEY_MAIN_VOLUME_PREVIOUS_LEVEL | Set main volume to previous level |
| number from 1 to 9 | Set the volume of the application under focus to x percent of the main volume (x equal to 10 multiplied by the number) |
| shift + number from 1 to 9 | Set to x the NVDA volume (x equal to 10 multiplied by the figure) |
| control + number from 1 to 9 | Set to x the main volume (x equal to 10 multiplied by the figure) |
| KEY_SPLIT_LEFT_FOCUS | Hear NVDA on the left and focused application on the right |
| KEY_SPLIT_LEFT_ALL | Hear NVDA on the left and all applications on the right |
| KEY_SPLIT_RIGHT_FOCUS | Hear NVDA on the right and focused application on the left |
| KEY_SPLIT_RIGHT_ALL | Hear NVDA on the right and all applications on the left |
| KEY_SPLIT_CENTER_FOCUS | Hear NVDA and focused at the center |
| KEY_SPLIT_CENTER_ALL | Hear NVDA and all applications at the center |
| KEY_CENTER_FOCUSED_APP | Hear focused application at the center |

++ input gestures installed by the functionalities ++

+++ Display of the list of icons in the notification area and windows of the applications launched +++
| Desktop computer | Laptop | Touch | Description |
| MAIN_KEY_ICONS_List | MAIN_KEY_ICONS_List | None | Shows the list of buttons on the System Tray. Twice, Display the running application windows's list with opportunity to put one of them on the foreground or destroy it |

+++ Help with the composition of complex symbols +++
| Desktop computer | Laptop | Touch | Description |
| MAIN_KEY_COMPLEX_SYMBOL | MAIN_KEY_COMPLEX_SYMBOL | None | Allow you to copy or type complex symbol |

+++ Information on the application under the focus +++
| Desktop computer | Laptop | Touch | Description |
| MAIN_KEY_REPORT_NAME_VERSION | MAIN_KEY_REPORT_NAME_VERSION | None | Report the application 's name and version |
| MAIN_KEY_CONFIGURATION_PROFILE | MAIN_KEY_CONFIGURATION_PROFILE | None | Speaks the filename of the active application along with the name of the currently loaded appModule python file. Pressing this key twice,speak the name and state of the current configuration profile |

+++ Extension of virtual buffer functionality +++
| Desktop computer | Laptop | Touch | Description |
| KEY_CURRENT_ROW_REPORT | KEY_CURRENT_ROW_REPORT | none | Report current table row's cells |
| KEY_CURRENT_COLUMN_REPORT | KEY_CURRENT_COLUMN_REPORT | none | Report current table column's cells |
| KEY_NEXT_ROW_REPORT | KEY_NEXT_ROW_REPORT | none | Move to and report next table row |
| KEY_PREVIOUS_ROW_REPORT | KEY_PREVIOUS_ROW_REPORT | none | Move to and report previous table row |
| KEY_NEXT_COLUMN_REPORT | KEY_NEXT_COLUMN_REPORT | none | Move to and report next table column |
| KEY_PREVIOUS_COLUMN_REPORT | KEY_PREVIOUS_COLUMN_REPORT | none | Move to and report previous table column |
| KEY1_CELL_POSITION_REPORT | KEY2_CELL_POSITION_REPORT | none | Report current table cell position |
| KEY_MOVE_FIRST_CELL_ROW | KEY_MOVE_FIRST_CELL_ROW | none | Move to first cell of table row |
| KEY_MOVE_LAST_CELL_ROW | KEY_MOVE_LAST_CELL_ROW | none | Move to last cell of table row |
| KEY_MOVE_FIRST_CELL_COLUMN | KEY_MOVE_FIRST_CELL_COLUMN | none | Move to first cell of table column |
| KEY_MOVE_LAST_CELL_COLUMN | KEY_MOVE_LAST_CELL_COLUMN | none | Move to last cell of table column |
| KEY1_DOCUMENT_ADDRESS | KEY2_DOCUMENT_ADDRESS | none | Report document 's address (URL). Twice: copy it to clipboard |

+++ Announcement of the folder preselect dialog boxes of the style Open, save, save as +++
| Desktop computer | Laptop | Touch | Description |
| MAIN_KEY_SAY_CURRENT_FOLDER | MAIN_KEY_SAY_CURRENT_FOLDER | None | report the name of current selected folder in the open or Save dialog box. Twice: report full path |

+++ NVDA logs +++
| Desktop computer | Laptop | Touch | Description |
| MAIN_KEY_LOG_VIEW | MAIN_KEY_LOG_VIEW | None | Open current NVDA log file. Pressing this key twice, open the old NVDA log file. Pressing third, copy current log path to the clipboard |

+++ Speech history +++
| Desktop computer | Laptop | Touch | Description |
| MAIN_KEY_PREVIOUS_RECORD | MAIN_KEY_PREVIOUS_RECORD | None | Report previous record of the speech history and copy it to clipboard |
| MAIN_KEY_NEXT_RECORD | MAIN_KEY_NEXT_RECORD | None | Report next record of the speech history and copy it to clipboard |
| MAIN_KEY_CURRENT_RECORD | MAIN_KEY_CURRENT_RECORD | None | Report current record of the speech history and copy it to clipboard. Twice: display speech history |

+++ Timer +++
| Desktop computer | Laptop | Touch | Description |
| MAIN_KEY_MINUTE_TIMER | MAIN_KEY_MINUTE_TIMER | None | Display dialog to start the minute timer.If minute timer already started, display dialog to report duration |

+++ Restarting NVDA +++
| Desktop computer | Laptop | Touch | Description |
| MAIN_KEY_RESTART_NVDA | MAIN_KEY_RESTART_NVDA | None | Restart NVDA. Twice: restart with log levelset to debug |

+++ Display of visible elements composing the object in the foreground +++
| Desktop computer | Laptop | Touch | Description |
| MAIN_KEY_OBJECTS_LIST | MAIN_KEY_OBJECTS_LIST | None | Reads all controls in the active window. If pressed twice: display the list's visible items making up it |

+++ Voice profile switching +++
| Desktop computer | Laptop | Touch | Description |
| MAIN_KEY_VOICEPROFILE_SELECTOR | MAIN_KEY_VOICEPROFILE_SELECTOR | None | Set selector x as current selector and Sets , if possible, it associated voice profile as current voice profile (x equals number 1 to 8) |
| MAIN_KEY_NEXT_VOICEPROFILE | MAIN_KEY_NEXT_VOICEPROFILE | None | Go to forward to the first selector associated to a voice profile and set this voice profile as current voice profile |
| MAIN_KEY_PREVIOUS_VOICEPROFILE | MAIN_KEY_PREVIOUS_VOICEPROFILE | None | Go backward to the first selector associated to a voice profile and set this voice profile as current voice profile |
| MAIN_KEY_MANAGE_SELECTOR | MAIN_KEY_MANAGE_SELECTOR | None | Display dialog to manage voice profile selectors (command: v) |
| MAIN_KEY_TOGGLE_VOICE_PROFIL_SWITCHING | MAIN_KEY_TOGGLE_VOICE_PROFIL_SWITCHING | none | Activate or deactivate Voice profile switching mode |

+++ Date and time - additions +++
| Desktop computer | Laptop | Touch | Description |
| KEY_DATE_TIME | KEY_DATE_TIME | none | Reports the current time. Twice, reports the current date. Third: copy date and time to the clipboard |

+++ Text analysis +++
| Desktop computer | Laptop | Touch | Description |
| MAIN_KEY_WORD_TEXT_ANALYZER | MAIN_KEY_WORD_TEXT_ANALYZER | none | Analyze word under cursor |
| MAIN_KEY_LINE_TEXT_ANALYZER | MAIN_KEY_LINE_TEXT_ANALYZER | none | Analyze Line Under Cursor |
| MAIN_KEY_SENTENCE_TEXT_ANALYZER | MAIN_KEY_SENTENCE_TEXT_ANALYZER | none | Analyze sentence under cursor |
| MAIN_KEY_PARAGRAPH_TEXT_ANALYZER | MAIN_KEY_PARAGRAPH_TEXT_ANALYZER | none | Analyze paragraph under cursor |
